
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C85EECD6-2CFD-5BA9-A60B-F7AF3A74E832.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:01:54 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2012" /><meta name="DC.rights.owner" content="(C) Copyright 2012" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="rbufexample: Using resizable buffer descriptors" /><meta name="abstract" content="This example application demonstrates how to use the RBuf class." /><meta name="description" content="This example application demonstrates how to use the RBuf class." /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-E3D2A6ED-8192-563D-8966-DD96B3AF1783" /><meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87" /><meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D" /><meta name="DC.Relation" scheme="URI" content="GUID-0D61EBFF-F513-5911-B234-09F36E5E3DC8" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-C85EECD6-2CFD-5BA9-A60B-F7AF3A74E832" /><meta name="DC.Language" content="en" /><title>rbufexample: Using resizable buffer descriptors </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp5.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-C85EECD6-2CFD-5BA9-A60B-F7AF3A74E832">rbufexample: Using resizable buffer descriptors</h1><div><p>This example application demonstrates how to use the <code class="codeph">RBuf</code> class. </p>
<p>RBuf is a resizable buffer descriptor. It is
part of the user library. It is used to contain strings and binary
data when the maximum size of the data is not known until run time. </p>
<p>This overview contains the following sections: </p>
<ul>
<li id="GUID-6A429EA8-8396-5A67-BF08-5CC81426D99A"><a name="GUID-6A429EA8-8396-5A67-BF08-5CC81426D99A"><!-- --></a><p> <a href="#GUID-7605348A-0F8B-56A4-A48C-C83CB1CD546D">Download</a> </p> </li>
<li id="GUID-9BBBEFB0-D463-5A81-9AF8-8FE0FB781D5A"><a name="GUID-9BBBEFB0-D463-5A81-9AF8-8FE0FB781D5A"><!-- --></a><p> <a href="#GUID-BC0B8F0D-94A8-51D1-9BC2-85E4F76C482A">Description</a> </p> </li>
<li id="GUID-4946F730-6E6A-5EC2-8A73-F0E29EBB09D9"><a name="GUID-4946F730-6E6A-5EC2-8A73-F0E29EBB09D9"><!-- --></a><p> <a href="#GUID-69043124-f5fc-499b-8550-0c5b6ed66fe5">Class summary</a> </p> </li>
<li id="GUID-4D0A67AF-FAC5-51F5-8C4F-5E9FBF1C2981"><a name="GUID-4D0A67AF-FAC5-51F5-8C4F-5E9FBF1C2981"><!-- --></a><p> <a href="#GUID-111B7B66-A3C4-5A15-8CF2-C6A227483651">Build</a> </p> </li>
<li id="GUID-F01C5F43-391A-562A-A6E2-B7C34A2FB01A"><a name="GUID-F01C5F43-391A-562A-A6E2-B7C34A2FB01A"><!-- --></a><p> <a href="#GUID-E30CC1D4-B854-5080-8F37-950CA4D86DD0">See also</a> </p> </li>
</ul>
<div id="GUID-7605348A-0F8B-56A4-A48C-C83CB1CD546D"><h3 class="section-title">Download</h3> <p>Click on the following link to download the example: <a href="GUID-6013A680-57F9-415B-8851-C4FA63356636/zips/guid-7520d937-647a-495a-9196-edca52b98e89.zip" target="_blank">rbufexample.zip</a>.</p><p>Click: <a href="GUID-6013A680-57F9-415B-8851-C4FA63356636/guid-7520d937-647a-495a-9196-edca52b98e89.html#GUID-6013A680-57F9-415B-8851-C4FA63356636/guid-7520d937-647a-495a-9196-edca52b98e89.html">browse</a> to view the example code.</p> </div>
<div id="GUID-BC0B8F0D-94A8-51D1-9BC2-85E4F76C482A"><h3 class="section-title">Description</h3> <ul>
<li id="GUID-87468748-0221-5005-9A98-EE03F5280421"><a name="GUID-87468748-0221-5005-9A98-EE03F5280421"><!-- --></a><p> <a href="#GUID-B2AF4A97-A93B-5437-A31D-85C98AFC7DBB"> Creating an RBuf</a> </p> </li>
<li id="GUID-6A66563D-F504-5D7E-8274-78126F2877F8"><a name="GUID-6A66563D-F504-5D7E-8274-78126F2877F8"><!-- --></a><p> <a href="#GUID-88B88124-BB7D-58DC-9F8A-61C32BDD58C4">Swapping two RBufs</a> </p> </li>
<li id="GUID-6F41B457-6A2B-5895-8404-DCE5F971B59B"><a name="GUID-6F41B457-6A2B-5895-8404-DCE5F971B59B"><!-- --></a><p> <a href="#GUID-893B2BF3-AD9F-587D-95D5-165014C932B4">Copying data to an RBuf using the assignment operator</a> </p> </li>
<li id="GUID-0B584C6E-A740-5CD6-A8F7-E2DA4327D2B9"><a name="GUID-0B584C6E-A740-5CD6-A8F7-E2DA4327D2B9"><!-- --></a><p> <a href="#GUID-2B6B8519-6306-5F0C-8A79-4094A3037901">Reallocating an RBuf</a> </p> </li>
<li id="GUID-D96AC20C-5F22-52F7-B299-F178B90AE214"><a name="GUID-D96AC20C-5F22-52F7-B299-F178B90AE214"><!-- --></a><p> <a href="#GUID-DE5A5DC0-07C6-50B9-AFDA-E69A92A02980"> Replacing and modifying the data in an RBuf</a> </p> </li>
</ul> <p id="GUID-B2AF4A97-A93B-5437-A31D-85C98AFC7DBB"><a name="GUID-B2AF4A97-A93B-5437-A31D-85C98AFC7DBB"><!-- --></a><strong>Creating
an RBuf</strong> </p> <p>The example demonstrates creating an RBuf in the following ways: </p> <ol id="GUID-B4E38F9F-B275-5364-B59C-71087CDDAF1C">
<li id="GUID-0482EE2B-165C-5B55-B819-741026C38F02"><a name="GUID-0482EE2B-165C-5B55-B819-741026C38F02"><!-- --></a><p> <strong>Using RBuf::Create()
or RBuf::CreateL():</strong> These functions create either an empty descriptor,
or one with data copied from another descriptor. </p> </li>
<li id="GUID-00E1680C-CB9C-5CC8-BC4A-C7337E0B9B9D"><a name="GUID-00E1680C-CB9C-5CC8-BC4A-C7337E0B9B9D"><!-- --></a><p> <strong>Using RBuf::CreateMax()
or RBuf::CreateMaxL():</strong> These functions set the buffer's current
length to be the same as its maximum length. </p> </li>
<li id="GUID-A0E4C908-5542-53D3-8452-BDA3BFB8887D"><a name="GUID-A0E4C908-5542-53D3-8452-BDA3BFB8887D"><!-- --></a><p> <strong>By assigning
from an HBufC:</strong> RBuf::Assign(HBufC8*) transfers
ownership of the heap descriptor. It is not possible to access the
original heap descriptor once ownership has been transferred. </p> </li>
<li id="GUID-B8812B95-CE27-5850-B866-F6DBC18ADF8C"><a name="GUID-B8812B95-CE27-5850-B866-F6DBC18ADF8C"><!-- --></a><p> <strong>By assigning
some previously allocated memory:</strong> RBuf::Assign(const
RBuf8&amp; ) transfers ownership of allocated memory. It
is then not possible to access the original memory. </p> </li>
<li id="GUID-9FCBF30F-815B-5CA9-B0B6-1698DA0C4F0E"><a name="GUID-9FCBF30F-815B-5CA9-B0B6-1698DA0C4F0E"><!-- --></a><p> <strong>Using RReadStream:</strong> The example writes some text to a file stream (<code class="codeph">RFileWriteStream</code>). Then it creates the buffer by passing the open stream object to RBuf::CreateL(TInt). </p> </li>
</ol><p><strong>Related APIs</strong></p><ul>
<li><p>RBuf - Defines a build-independent resizable
buffer descriptor.</p></li>
<li><p>RBuf::Assign(const RBuf8&amp;)</p></li>
<li><p>RBuf::Create(const TDesC8&amp;)</p></li>
<li><p>RBuf::CreateL(const TDesC8&amp;)</p></li>
<li><p>RBuf::CreateMax(TInt)</p></li>
<li><p>RBuf::CreateMaxL(TInt)</p></li>
</ul> <p id="GUID-88B88124-BB7D-58DC-9F8A-61C32BDD58C4"><a name="GUID-88B88124-BB7D-58DC-9F8A-61C32BDD58C4"><!-- --></a><strong>Swapping
two RBufs</strong> </p> <p>The example creates two resizable buffers using RBuf::Create(const TDesC8&amp;). Then it swaps the contents
of them using RBuf::Swap(RBuf8&amp;). </p> <p> <strong>Note:</strong> When you swap data between two <code class="codeph">RBuf</code> s
ensure that the maximum length of the target <code class="codeph">RBuf</code> is sufficient to hold the data, otherwise a panic (<code class="codeph">User
11</code>) occurs. </p><p><strong>Related APIs</strong></p><ul>
<li><p>RBuf::Create(const TDesC8&amp;)</p></li>
<li><p>RBuf::Swap(RBuf8&amp;)</p></li>
</ul> <p id="GUID-893B2BF3-AD9F-587D-95D5-165014C932B4"><a name="GUID-893B2BF3-AD9F-587D-95D5-165014C932B4"><!-- --></a><strong>Copying
data to an RBuf using the assignment operator</strong> </p> <p>The example
creates two resizable buffers and allocates memory using RBuf::Create(const TDesC8&amp;). It then copies data to
these buffers. It also copies data from the first buffer to the second
buffer using the assignment operator. </p> <p> <strong> Notes:</strong> </p> <ul>
<li id="GUID-9B2835F9-BD3E-56DD-9CFD-F71677FFC71C"><a name="GUID-9B2835F9-BD3E-56DD-9CFD-F71677FFC71C"><!-- --></a><p>When you use RBuf::Assign(const RBuf8&amp;), ownership of the buffer
is transferred. <code class="codeph">Assign(const RBuf8&amp;)</code> neither
checks nor frees any pre-existing owned allocated memory. If this
descriptor already owns some allocated memory, <a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html#GUID-32EB41B6-A1C8-326C-9D52-095B05D4D20B"><code class="apiname">RBuf16::Close()</code></a> should be invoked on it before calling RBuf::Assign(const
RBuf8&amp;), otherwise a memory leak will occur. </p> </li>
<li id="GUID-41218102-1810-5E83-BAEE-5683D378F75F"><a name="GUID-41218102-1810-5E83-BAEE-5683D378F75F"><!-- --></a><p>When you use
the assignment operator, you must make sure the target descriptor's
maximum length is equal to or greater than the length of the source
descriptor, otherwise a <code class="codeph">User 11</code> panic (descriptor
overflow) occurs. Any existing data in the target descriptor is replaced. </p> </li>
</ul> <p><strong>Related APIs</strong></p><ul>
<li><p><a href="GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-BEFF9C91-DA64-3032-96E8-F5054405DC74.html#GUID-32EB41B6-A1C8-326C-9D52-095B05D4D20B"><code class="apiname">RBuf16::Close()</code></a></p></li>
<li><p> RBuf::Assign(const RBuf8&amp;)</p></li>
<li><p>RBuf::Create(TInt)</p></li>
</ul><p id="GUID-2B6B8519-6306-5F0C-8A79-4094A3037901"><a name="GUID-2B6B8519-6306-5F0C-8A79-4094A3037901"><!-- --></a><strong>Reallocating
an RBuf</strong> </p> <p>The example creates a resizable buffer descriptor,
then it resizes it using <code class="codeph">RBuf::ReAlloc(TInt)</code>. The
old and new lengths are printed to the console to show how <code class="codeph">ReAlloc()</code> does not change the length of the descriptor,
but only its maximum length. Calling RBuf::ReAlloc(TInt) with a value of zero frees the memory and sets the length and maximum
length to zero. </p><p><strong>Related APIs</strong></p><ul>
<li><p>RBuf::ReAlloc(TInt)</p></li>
</ul> <p id="GUID-DE5A5DC0-07C6-50B9-AFDA-E69A92A02980"><a name="GUID-DE5A5DC0-07C6-50B9-AFDA-E69A92A02980"><!-- --></a><strong> Replacing
and modifying the data in an RBuf</strong> </p> <p>The example creates
a resizable buffer descriptor and replaces a portion of the data in
it using RBuf::Replace(TInt ,TInt ,const TDesC16&amp;). The start position and length of the data to be replaced, and the
replacement text are passed as parameters. RBuf::Delete(TInt
, TInt) is then used to delete the replacement text, by
specifying the position and length of the data to be deleted. </p><p><strong>Related APIs</strong></p><ul>
<li><p>RBuf::Delete(TInt , TInt)</p></li>
<li><p>RBuf::Replace(TInt ,TInt ,const TDesC16&amp;)</p></li>
</ul> </div>
<div id="GUID-69043124-F5FC-499B-8550-0C5B6ED66FE5"><h3 class="section-title">Class
summary</h3><ul>
<li><p>RBuf - Defines a build-independent resizable
buffer descriptor.</p></li>
<li><p> HBufC - Defines a build-independent heap
descriptor.</p></li>
<li><p>RFileWriteStream - Supports the writing
of a stream to a file.</p></li>
<li><p>RFileReadStream - Supports the reading of
a stream from a file.</p></li>
<li><p>RFs</p></li>
</ul></div>
<div id="GUID-111B7B66-A3C4-5A15-8CF2-C6A227483651"><h3 class="section-title">Build</h3> <p> The example builds an executable file called <code>rbufexample.exe</code> in the standard location (<code>\epoc32\release\winscw\&lt;build_variant&gt;</code> for the emulator). After launching the executable, depending on
the emulator you are using, you may need to navigate away from the
application launcher/shell screen to view the console. </p> </div>
<div id="GUID-E30CC1D4-B854-5080-8F37-950CA4D86DD0"><h3 class="section-title">See
also</h3> <p> <a href="GUID-4AC3CC42-6E8D-584A-AA39-84B5E0F3C16A.html">How to use the resizable buffer descriptor - RBuf</a> </p> </div>
</div></div></div><div class="footer"><p class="metadata">Last updated August 11th, 2011</p><hr /><div class="copy">Â© Nokia 2012.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C85EECD6-2CFD-5BA9-A60B-F7AF3A74E832.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:01:56 GMT -->
</html>