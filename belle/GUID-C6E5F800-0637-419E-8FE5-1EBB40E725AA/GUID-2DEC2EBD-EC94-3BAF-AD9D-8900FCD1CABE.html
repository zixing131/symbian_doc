<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:14:10 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta name="DC.Type" content="cxxClass" />
<meta name="DC.Title" content="CImap4ClientMtm" />
<meta name="abstract" content="" />
<meta name="description" content="" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE" />
<title>CImap4ClientMtm</title>
<meta name="keywords" content="api" /><link rel="stylesheet" type="text/css" href="css/nokiacxxref.css" />
<link href="css/s60/style.css" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp3.html" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category-cover_cpp3.html" rel="stylesheet" type="text/css" /></head>
<body id="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE"><a name="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE"><!-- --></a><div class="body"><div class="contentLeft prTxt">
<h1 class="sectiontitle">CImap4ClientMtm Class Reference</h1>
<div class="state state apiQualifier apiQualifier cxxClassDeclarationFile section include"><p>#include 
            
                    &lt;mw/impcmtm.h&gt;
                </p></div>
<div class="section signature"><table class="signature"><tr><td>class CImap4ClientMtm : public MImUndoOffLineOperation</td></tr></table></div><div class="ph ph apiDefItem apiDefItem cxxClassDerivations section derivation"><h2 class="sectiontitle">Inherits from</h2><ul class="derivation derivation-root"><li class="derivation-depth-0 ">CImap4ClientMtm<ul class="derivation"><li class="derivation-depth-1 "><a class="xref xref apiRelation apiBaseClassifier cxxClassBaseClass" href="GUID-D66D9D87-856B-3129-BF71-40F96AC83039.html">MImUndoOffLineOperation</a></li></ul></li></ul></div>
<div class="section member-index"><table class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code"></td><td><a href="#GUID-638FDC34-A195-3CD2-81B7-63B142447C56">~CImap4ClientMtm</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-D3A03F4D-0F8E-342F-8B00-1E113D76F80D">AddAddresseeL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-6651EC0D-20CB-3104-AF97-B0DF7F903B49">AddAddresseeL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-99CC3A7D-8E15-37AB-8B9B-5A88021F8730">AddAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-01FDD502-568C-3FDE-BD96-F98E1B24733A">AddAttachmentL</a>(RFile &amp;, const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-06792D11-6D88-3749-AF7F-C1AB73EE4416">AddEntryAsAttachmentL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-378408E7-554E-36B3-9791-467481311E61">AddLinkedAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-61608F6D-7DF5-30FB-B0F2-535DBFBE5AB2">ChangeDefaultServiceL</a>(const TMsvId &amp;)</td></tr><tr><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-E18366DC-0C1F-3168-80F6-450D8DBD7016">CreateAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, RFile &amp;, const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-08B02BE4-045E-3882-819C-0881A2ACE38C">CreateMessageL</a>(TMsvId)</td></tr><tr><td align="right" class="code">virtual IMPORT_C TMsvId</td><td><a href="#GUID-30BA3059-FF43-3F44-B47B-367AB0128C7A">DefaultServiceL</a>()</td></tr><tr class="bg"><td align="right" class="code">TMsvPartList</td><td><a href="#GUID-F0E40C74-ADC6-3521-9107-2329AC656CC7">Find</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, TMsvPartList)</td></tr><tr><td align="right" class="code">CMsvOperation *</td><td><a href="#GUID-133374AB-69C9-353F-A717-F49A0896DBB2">ForwardL</a>(TMsvId, TMsvPartList, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-E139F3A1-2FB6-3810-88EE-761ACC0A4FDB">HandleEntryEvent</a>(TMsvEntryEvent, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TAny</a> *, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TAny</a> *, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TAny</a> *)</td></tr><tr><td align="right" class="code">IMPORT_C const <a class="xref xref apiRelation" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html">CImImap4Settings</a> &amp;</td><td><a href="#GUID-86EF8720-B11D-31DB-AA99-51EC64E028E5">Imap4Settings</a>()</td></tr><tr class="bg"><td align="right" class="code">CMsvOperation *</td><td><a href="#GUID-0D719D79-BBDD-30F8-876E-89ADA897340B">InvokeAsyncFunctionL</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>, const <a class="xref xref apiRelation" href="GUID-6BC8851B-D913-3CE5-B343-5163661E8AD5.html">CMsvEntrySelection</a> &amp;, <a class="xref xref apiRelation" href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp;, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-9BB08680-9B62-3D5C-BFB4-4928FDFE603D">InvokeSyncFunctionL</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>, const <a class="xref xref apiRelation" href="GUID-6BC8851B-D913-3CE5-B343-5163661E8AD5.html">CMsvEntrySelection</a> &amp;, <a class="xref xref apiRelation" href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-03574D25-50B5-3CDB-9361-6FCD8D102EE6">LoadMessageL</a>()</td></tr><tr><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html">CImap4ClientMtm</a> *</td><td><a href="#GUID-AD7C66DC-2446-3150-A566-5073645679D4">NewL</a>(CRegisteredMtmDll &amp;, CMsvSession &amp;)</td></tr><tr class="bg"><td align="right" class="code">
<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
</td><td><a href="#GUID-BCA34BB0-D83A-3336-8338-51C633A67523">QueryCapability</a>(<a class="xref xref apiRelation" href="GUID-530281E6-29FC-33F2-BC9B-610FBA389444.html">TUid</a>, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C CImOperationQueueList *</td><td><a href="#GUID-AB74A4DA-E9CD-3795-8525-975E83B7F989">QueueListL</a>(CMsvEntry &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-A6BDD58F-8E8A-34F4-8F0A-79C4D3CCD2EC">RemoveAddressee</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-C817EA3F-113F-3494-A005-06B3F1E680D3">RemoveDefaultServiceL</a>()</td></tr><tr class="bg"><td align="right" class="code">CMsvOperation *</td><td><a href="#GUID-19E9124D-6C72-35A1-8306-36DB46947D1D">ReplyL</a>(TMsvId, TMsvPartList, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-B43DAFC2-3AAE-37BA-AAB5-173B538413E3">RestoreL</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-51143C41-A411-3F4F-BB84-D6231DBA0275">RestoreSettingsL</a>()</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-1F149AF9-0BB1-3345-8C32-9C7859603087">SaveMessageL</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-08575A13-24E1-35D8-B378-56BFC99FA069">SetImap4SettingsL</a>(const <a class="xref xref apiRelation" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html">CImImap4Settings</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-D952EDAE-9DDB-31F6-8C4B-2DCF66E8319E">StoreL</a>()</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-05268D43-66C9-37AD-921B-A3632E0CF6DC">StoreSettingsL</a>()</td></tr><tr><td align="right" class="code">virtual void</td><td><a href="#GUID-8BC6011B-AEF7-3B17-8B58-AC581376285B">UndoOffLineChangesL</a>(const CImOffLineOperation &amp;, TMsvId)</td></tr><tr class="bg"><td align="right" class="code">
<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>
</td><td><a href="#GUID-AECE12EA-5049-35FF-A733-640FCABE06E4">ValidateMessage</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>)</td></tr></tbody></table><table class="member-index"><thead><tr><th colspan="2">Protected Member Functions</th></tr></thead><tbody><tr><td align="right" class="code"></td><td><a href="#GUID-030E5700-402E-3FE8-94CD-6EA08A3026C8">CImap4ClientMtm</a>(CRegisteredMtmDll &amp;, CMsvSession &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-4DDC50FA-E105-3835-8505-AC2C25EAE121">ConstructL</a>()</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-225E4F65-7408-367B-B667-9234C92B1CA1">ContextEntrySwitched</a>()</td></tr></tbody></table></div><div class="section section apiDesc section apidesc"><h2 class="sectiontitle">Detailed Description</h2>
<p class="p">IMAP4 client MTM interface, providing access to the email services using the IMAP4 protocol.</p>
<p class="p">The class provides support for:</p>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">connecting to remote IMAP4 mail servers</p>
</li>
<li class="li">
<p class="p">synchronising message headers with mailboxes on these servers</p>
</li>
<li class="li">
<p class="p">getting message bodies and attachments</p>
</li>
<li class="li">
<p class="p">copying and moving messages</p>
</li>
<li class="li">
<p class="p">creating messages that forward or reply to IMAP4 messages</p>
</li>
<li class="li">
<p class="p">server notification of new messages using IMAP IDLE</p>
</li>
<li class="li">
<p class="p">queueing operations requested when there is no connection to a mail server, to be performed when a connection is made (offline operations).</p>
</li>
</ul>
</div>
<p class="p">Note that <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE">CImap4ClientMtm</a> does not support many of the generic functions defined by the <tt class="ph tt">CBaseMtm</tt> base class. In particular:</p>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">Message address information, body, subjects, and attachments are not manipulated through <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE">CImap4ClientMtm</a>. Consequently, <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-1F149AF9-0BB1-3345-8C32-9C7859603087">SaveMessageL()</a> has an empty implementation, and is not used. Message access and manipulation is instead done through <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a>, which understands the email specific message formats, including MHTML (RFC 2557). The RFC 822 email header, which includes subject and address information, is encapsulated in a <a class="xref" href="GUID-C97C8B4F-C862-336C-85B0-BB116A26DE15.html#GUID-C97C8B4F-C862-336C-85B0-BB116A26DE15">CImHeader</a> object, which can be obtained from a <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a> object. IMAP also has its own specific flags, such as draft, answered, and deleted: this can be accessed through <a class="xref" href="GUID-96CB1F06-0642-3313-8E18-1F68CBE26CCB.html#GUID-96CB1F06-0642-3313-8E18-1F68CBE26CCB">TMsvEmailEntry</a>, which extends the message server's generic <a class="xref" href="GUID-5A23B804-2C06-3407-9D48-1BFB212D699F.html#GUID-5A23B804-2C06-3407-9D48-1BFB212D699F">TMsvEntry</a> to add email-specific information.</p>
</li>
</ul>
</div>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">The idea of a default service used by base class functions <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-30BA3059-FF43-3F44-B47B-367AB0128C7A">DefaultServiceL()</a>, <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-61608F6D-7DF5-30FB-B0F2-535DBFBE5AB2">ChangeDefaultServiceL()</a>, and <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-C817EA3F-113F-3494-A005-06B3F1E680D3">RemoveDefaultServiceL()</a> is not supported.</p>
</li>
</ul>
</div>
<p class="p">IMAP specific commands are issued through the <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-0D719D79-BBDD-30F8-876E-89ADA897340B">InvokeAsyncFunctionL()</a> function, with the commands defined in the <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-66B8E85D-5101-3BC5-BF6A-4F0FB73CE15D">TImap4Cmds</a> enumeration. Details of particular commands are given in the documentation for that enumeration, but the following describes some of the key concepts required to use those commands. Note that usually these commands do not correspond directly to the IMAP protocol commands described in RFC 3501. Instead, they are at a higher level, to simplify the logic required for an email client program.</p>
<p class="p">--------------------------------------</p>
<p class="p">Connection and services</p>
<p class="p">Settings for connection to and use of an IMAP4 mail server and its mailboxes are encapsulated in an <a class="xref" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html#GUID-55F11633-988C-39D5-ADE7-23C4966FD995">CImImap4Settings</a> object, created and accessed through <a class="xref" href="GUID-A7EF08E6-82AF-3577-B942-ABD532EDB7FE.html#GUID-A7EF08E6-82AF-3577-B942-ABD532EDB7FE">CEmailAccounts</a>. Preferences for the network connection (e.g. the ISP to use) to be made to access an IMAP server are also accessed through <a class="xref" href="GUID-A7EF08E6-82AF-3577-B942-ABD532EDB7FE.html#GUID-A7EF08E6-82AF-3577-B942-ABD532EDB7FE">CEmailAccounts</a>.</p>
<p class="p">The settings are associated with a service-type entry in the Message Server's message store. Message and folder type entries under the service entry store a local copy of the mailboxes and messages that are present on an IMAP server. For this reason, the service is sometimes referred to as the local mirror of an IMAP server.</p>
<p class="p">By default, it is assumed that the user has a primary mailbox on the server called INBOX, though this can be changed if necessary using <a class="xref" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html#GUID-B029036D-3D51-31C0-8F27-77F68FB5C1B8">CImImap4Settings::SetFolderPathL()</a>. (To avoid confusion, the term "Inbox" used in the IMAP MTM documentation refers to this mailbox, rather than the Message Server's standard local Inbox folder.)</p>
<p class="p">The settings store the user's log-in details required to access the IMAP server, and other settings not related to connection, but which affect the behaviour of commands, such as synchronisation, made to the service.</p>
<p class="p">--------------------------------------</p>
<p class="p">Synchronisation</p>
<p class="p">The IMAP4 MTM provides the means to synchronise message headers on a remote IMAP mailboxes with the messages headers on the phone. Note that synchronisation only refers to message headers. Once headers are synchronised, populate operations (i.e. getting the message bodies) can be done.</p>
<p class="p">The basic steps involved in a full synchronisation are:</p>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">The headers of messages in the Inbox are synchronised.</p>
</li>
<li class="li">
<p class="p">The local list of folders is synchronised with those existing on the remote IMAP service. Depending on the service settings, the local or remote settings of subscribed mailboxes may be updated (see below for more information).</p>
</li>
<li class="li">
<p class="p">The headers of messages in subscribed folders are synchronised.</p>
</li>
</ul>
</div>
<p class="p">Queued offline operations (see below) pending on the Inbox or subscribed folders are performed prior to the relevant folder being synchronised.</p>
<p class="p">Synchronisations can be performed in the background or the foreground. A foreground synchronisation means no other requests, such as message fetching, can be made to the MTM, until the synchronisation is complete. A background synchronisation allows some types of command to be given while it is in progress. Commands that write to the remote server are not allowed however while a background synchronisation is in progress. A client is informed of the state of a background synchronisation through the <a class="xref" href="GUID-BFBF3144-0EF3-357C-9496-90FECC4AF405.html#GUID-BFBF3144-0EF3-357C-9496-90FECC4AF405">MMsvImapConnectionObserver</a> callback interface.</p>
<p class="p">Synchronisations commands are made through <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-0D719D79-BBDD-30F8-876E-89ADA897340B">CImap4ClientMtm::InvokeAsyncFunctionL()</a>. There a variety of commands available that give different options for compounding synchronisation with other commands, such as connection, and synchronising only particular folders. See TImap4Cmds for details. Progress information for synchronisation commands can be obtained from the CMsvOperation object returned by the <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-0D719D79-BBDD-30F8-876E-89ADA897340B">InvokeAsyncFunctionL()</a>. Synchronisation progress information is encapsulated in a <a class="xref" href="GUID-FAE36054-2509-3BAE-B4F2-C45C829D8E6F.html#GUID-FAE36054-2509-3BAE-B4F2-C45C829D8E6F">TImap4SyncProgress</a> object.</p>
<p class="p">Settings that affect how a synchronisation is performed include:</p>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">Subscriptions: when an IMAP service had been synchronised, the Messaging server will contain entries for all folders on the remote server. These entries will be marked invisible within the <a class="xref" href="GUID-5A23B804-2C06-3407-9D48-1BFB212D699F.html#GUID-5A23B804-2C06-3407-9D48-1BFB212D699F">TMsvEntry</a> for the folder, implying that they should be invisible to the user. Messages in these folders are not synchronised unless the folder has been subscribed to. Note a folder subscription can be set either locally (i.e. just on the phone), using the <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-6BF4087C-7E5D-3BCC-B099-5F9ED251F0DC">KIMAP4MTMLocalSubscribe</a> command, or remotely (on the server), possibly through email clients on other devices. A service can be set to synchronise folders using either or both of these types of subscription (<a class="xref" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html#GUID-B22C3F75-D37D-3AD8-8996-1ABA1ED07481">CImImap4Settings::SetSynchronise()</a>). Local and remote subscriptions can themselves be synchronised in various ways (CImImap4Settings::SetSuscribe()).</p>
</li>
</ul>
</div>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">Filters: a filter prevents certain e-mail messages from being synchronised onto the device when a client requests a synchronisation. Filters can include anything permitted by the IMAP Search command, including date, size, content, and message flags.</p>
</li>
</ul>
</div>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">Limits: service settings can limit the number of emails synchronised to the inbox (<a class="xref" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html#GUID-75D80E88-1B8D-352D-AC82-918C987E5681">CImImap4Settings::SetInboxSynchronisationLimit()</a>), and to other folders (<a class="xref" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html#GUID-B9CC464B-7C62-34E3-8871-2BDEAD55D793">CImImap4Settings::SetMailboxSynchronisationLimit()</a>).</p>
</li>
</ul>
</div>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">Sync rate: one of the synchronisation commands (KIMAP4MTMConnectAndSyncCompleteAfterDisconnect) periodically resynchronises the Inbox until the service is disconnected. <a class="xref" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html#GUID-1F7C7110-6538-3A70-9B22-C187DCDA6770">CImImap4Settings::SyncRate()</a> sets the refresh period.</p>
</li>
</ul>
</div>
<p class="p">--------------------------------------</p>
<p class="p">Getting and copying messages</p>
<p class="p">After messages headers have been synchronised, message bodies and attachments can be fetched from the remote email server. Getting message parts and saving them in the mirror service is calling populating them.</p>
<p class="p">Commands for these actions can be made through <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-0D719D79-BBDD-30F8-876E-89ADA897340B">CImap4ClientMtm::InvokeAsyncFunctionL()</a>. There are a large number of commands, for different combinations of these options:</p>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">action type: whether to just populate messages, or to also copy or move them to a local folder</p>
</li>
<li class="li">
<p class="p">message selection: whether to get all, new, or selected messages</p>
</li>
<li class="li">
<p class="p">connection: whether to make a new connection or assume an existing connection</p>
</li>
<li class="li">
<p class="p">disconnect: whether to disconnect or stay online after operation is complete</p>
</li>
</ul>
</div>
<p class="p">For the populate type commands, further options can be set that control the message getting behaviour. Basic options control, encapsulated in <a class="xref" href="GUID-766F611D-FCB8-33EA-BB7B-6B4612C7CACC.html#GUID-766F611D-FCB8-33EA-BB7B-6B4612C7CACC">TImImap4GetMailInfo</a>, specify whether body text and/or attachments are fetched, and a maximum message size. There are also options, encapsulated in <a class="xref" href="GUID-923C3D66-91A8-31E6-AC2A-C6FEB3D084CA.html#GUID-923C3D66-91A8-31E6-AC2A-C6FEB3D084CA">TImImap4GetPartialMailInfo</a>, that allow size limits to be separately specified for body text and/or attachments. If the the body is larger than the limit, then the body is partially downloaded up to the limit. Only attachments smaller than the specified size are downloaded. A partially downloaded message can later be fully downloaded.</p>
<p class="p">For the copy or move type commands, a <a class="xref" href="GUID-766F611D-FCB8-33EA-BB7B-6B4612C7CACC.html#GUID-766F611D-FCB8-33EA-BB7B-6B4612C7CACC">TImImap4GetMailInfo</a> parameter is supplied, in order to specify the destination folder for the messages, and a maximum message size.</p>
<p class="p">Progress information for getting commands can be obtained from the CMsvOperation object returned by the <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-0D719D79-BBDD-30F8-876E-89ADA897340B">InvokeAsyncFunctionL()</a>. Progress information is encapsulated in a <a class="xref" href="GUID-B11BF7F3-4D60-3AE4-8929-4D594D5F6E2B.html#GUID-B11BF7F3-4D60-3AE4-8929-4D594D5F6E2B">TImap4GenericProgress</a> object.</p>
<p class="p">Fetching and then copying or moving specified messages can also be performed by using the standard Messaging Framework <tt class="ph tt">CMsvEntry::CopyL()</tt> and <tt class="ph tt">CMsvEntry::MoveL()</tt> functions on entries under the remote service. If these functions are used, then the entire message is fetched without size limits.</p>
<p class="p">CMsvEntry functions can also be used to:</p>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">create a folder on a remote server</p>
</li>
<li class="li">
<p class="p">delete messages</p>
</li>
<li class="li">
<p class="p">copy or move messages from a local folder into a remote folder</p>
</li>
<li class="li">
<p class="p">copy or move messages between remote folders</p>
</li>
</ul>
</div>
<p class="p">Note that changing an existing entry through CMsvEntry is not supported. An MTM- specific command <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-E2244103-14D6-3D4F-8432-081F632924DD">KIMAP4MTMRenameFolder</a> is instead provided to rename a remote folder.</p>
<p class="p">The page "CMsvEntry functions for IMAP4 message entries", linked to in the "See also" section below, provides more details on using CMsvEntry.</p>
<p class="p">--------------------------------------</p>
<p class="p">Offline operations</p>
<p class="p">Some operations can only be performed while online, while other commands may be stored while offline for processing when next connected. An attempt to perform a command while offline that requires the MTM to be connected results in immediate completion with the error code KErrDisconnected.</p>
<p class="p">Permitted offline operations include:</p>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">copy</p>
</li>
<li class="li">
<p class="p">move</p>
</li>
<li class="li">
<p class="p">delete</p>
</li>
</ul>
</div>
<p class="p">Queued offline operations are usually performed when a connection is made, prior to the relevant folder being synchronised. Delete operations can alternatively be set to be done on disconnection using the service setting <a class="xref" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html#GUID-2BEE36B2-7C99-3A3F-BA78-839A99F0FDF6">CImImap4Settings::SetDeleteEmailsWhenDisconnecting()</a>.</p>
<div class="p">Note that:<ul class="ul"><li class="li"><p class="p">Offline operations are only permitted if the service setting SetDisconnectedUserMode() is true.</p>
</li>
<li class="li"><p class="p">It is possible to undo pending offline operations using the commands <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-06AF96F1-662B-380E-8CA1-030284FDB0D7">KIMAP4MTMCancelOffLineOperations</a> and <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-FF2B90C4-6507-38E2-A617-82A387493416">KIMAP4MTMUndeleteAll</a>.</p>
</li>
</ul>
</div>
<p class="p">--------------------------------------</p>
<p class="p">IMAP IDLE support</p>
<p class="p">IMAP IDLE (RFC 2177) is an optional expansion of the IMAP email accessing protocol that allows the server to send updates to the client that messages have been created or deleted in real time. The IDLE command is sent from the client to the server when the client is ready to accept unsolicited mailbox update messages. Whether the client requests the server to provide IDLE support is set in the <a class="xref" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html#GUID-BFA1C3AB-0E90-34F4-92AC-2828A35A1D2A">CImImap4Settings::SetImapIdle()</a> service setting. When the IMAP MTM receives such a notification, it synchronises the changed folder. Email clients can be notified of such changes by setting a MMsvEntryObserver observer on a folder.</p>
</div>
<h2 class="sectiontitle">Constructor &amp; Destructor Documentation</h2><div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-030E5700-402E-3FE8-94CD-6EA08A3026C8"><a name="GUID-030E5700-402E-3FE8-94CD-6EA08A3026C8"><!-- --></a>
<a name="GUID-662D1107-D017-3CEF-8B89-D6FAF6E3B4CE"><!-- --></a><h3 class="sectiontitle">CImap4ClientMtm ( CRegisteredMtmDll &amp;, CMsvSession &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>CImap4ClientMtm</td><td>(</td><td>CRegisteredMtmDll &amp;</td><td><span class="parameter">aRegisteredMtmDll</span>,</td></tr><tr><td colspan="2"> </td><td>CMsvSession &amp;</td><td><span class="parameter">aSession</span></td></tr><tr><td colspan="1"> </td><td>)</td><td colspan="2">[protected]</td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-638FDC34-A195-3CD2-81B7-63B142447C56"><a name="GUID-638FDC34-A195-3CD2-81B7-63B142447C56"><!-- --></a>
<h3 class="sectiontitle">~CImap4ClientMtm (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>~CImap4ClientMtm</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Destructor. </p>
</div>
</div>
</div>
<h2 class="sectiontitle">Member Function Documentation</h2><div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-D3A03F4D-0F8E-342F-8B00-1E113D76F80D"><a name="GUID-D3A03F4D-0F8E-342F-8B00-1E113D76F80D"><!-- --></a>
<a name="GUID-24FE548F-C20C-3159-8D78-241387ABE617"><!-- --></a><h3 class="sectiontitle">AddAddresseeL ( const TDesC &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddAddresseeL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aRealAddress</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Message address function required by the base class, but not used for IMAP.</p>
<p class="p">To modify message address information, use the address functions in <a class="xref" href="GUID-C97C8B4F-C862-336C-85B0-BB116A26DE15.html#GUID-C97C8B4F-C862-336C-85B0-BB116A26DE15">CImHeader</a>.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aRealAddress</td><td>Address.  </td></tr></table></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-6651EC0D-20CB-3104-AF97-B0DF7F903B49"><a name="GUID-6651EC0D-20CB-3104-AF97-B0DF7F903B49"><!-- --></a>
<h3 class="sectiontitle">AddAddresseeL ( const TDesC &amp;, const TDesC &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddAddresseeL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aRealAddress</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aAlias</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Message address function required by the base class, but not used for IMAP.</p>
<p class="p">To modify message address information, use the address functions in <a class="xref" href="GUID-C97C8B4F-C862-336C-85B0-BB116A26DE15.html#GUID-C97C8B4F-C862-336C-85B0-BB116A26DE15">CImHeader</a>.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aRealAddress</td><td>Address.  </td></tr><tr class="bg"><td class="parameter">aAlias</td><td>Alias information.  </td></tr></table></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-99CC3A7D-8E15-37AB-8B9B-5A88021F8730"><a name="GUID-99CC3A7D-8E15-37AB-8B9B-5A88021F8730"><!-- --></a>
<a name="GUID-8B092E07-8CE8-35F1-91D1-ABA848DDC57F"><!-- --></a><h3 class="sectiontitle">AddAttachmentL ( const TDesC &amp;, const TDesC8 &amp;, TUint, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>AddAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFilePath</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td><span class="parameter">aMimeType</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td><span class="parameter">aCharset</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<p class="p">To modify message attachments, use <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a>.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFilePath</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aMimeType</td><td>Unused  </td></tr><tr><td class="parameter">aCharset</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Unused  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-01FDD502-568C-3FDE-BD96-F98E1B24733A"><a name="GUID-01FDD502-568C-3FDE-BD96-F98E1B24733A"><!-- --></a>
<h3 class="sectiontitle">AddAttachmentL ( RFile &amp;, const TDesC8 &amp;, TUint, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>AddAttachmentL</td><td>(</td><td>RFile &amp;</td><td><span class="parameter">aFile</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td><span class="parameter">aMimeType</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td><span class="parameter">aCharset</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<p class="p">To modify message attachments, use <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a>.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFile</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aMimeType</td><td>Unused  </td></tr><tr><td class="parameter">aCharset</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Unused  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-06792D11-6D88-3749-AF7F-C1AB73EE4416"><a name="GUID-06792D11-6D88-3749-AF7F-C1AB73EE4416"><!-- --></a>
<a name="GUID-71F74A00-754B-3A8E-AF30-CAC39F4A61F1"><!-- --></a><h3 class="sectiontitle">AddEntryAsAttachmentL ( TMsvId, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>AddEntryAsAttachmentL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aAttachmentId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<p class="p">To modify message attachments, use <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a>.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aAttachmentId</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Unused  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-378408E7-554E-36B3-9791-467481311E61"><a name="GUID-378408E7-554E-36B3-9791-467481311E61"><!-- --></a>
<a name="GUID-88962E6D-F026-3021-9A01-D032ADFB0F2A"><!-- --></a><h3 class="sectiontitle">AddLinkedAttachmentL ( const TDesC &amp;, const TDesC8 &amp;, TUint, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>AddLinkedAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFilePath</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td><span class="parameter">aMimeType</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td><span class="parameter">aCharset</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<p class="p">To modify message attachments, use <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a>.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFilePath</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aMimeType</td><td>Unused  </td></tr><tr><td class="parameter">aCharset</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Unused  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-61608F6D-7DF5-30FB-B0F2-535DBFBE5AB2"><a name="GUID-61608F6D-7DF5-30FB-B0F2-535DBFBE5AB2"><!-- --></a>
<a name="GUID-34071237-DD68-3FFD-82FC-3658F8D26E67"><!-- --></a><h3 class="sectiontitle">ChangeDefaultServiceL ( const TMsvId &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>ChangeDefaultServiceL</td><td>(</td><td>const TMsvId &amp;</td><td><span class="parameter">aService</span></td><td>)</td><td>[virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aService</td><td>Unused  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-4DDC50FA-E105-3835-8505-AC2C25EAE121"><a name="GUID-4DDC50FA-E105-3835-8505-AC2C25EAE121"><!-- --></a>
<h3 class="sectiontitle">ConstructL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>ConstructL</td><td>(</td><td>)</td><td>[protected]</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-225E4F65-7408-367B-B667-9234C92B1CA1"><a name="GUID-225E4F65-7408-367B-B667-9234C92B1CA1"><!-- --></a>
<h3 class="sectiontitle">ContextEntrySwitched (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>ContextEntrySwitched</td><td>(</td><td>)</td><td>[protected]</td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-E18366DC-0C1F-3168-80F6-450D8DBD7016"><a name="GUID-E18366DC-0C1F-3168-80F6-450D8DBD7016"><!-- --></a>
<a name="GUID-AAC5DF86-76D8-3D5C-86B1-6D06EABD19E3"><!-- --></a><h3 class="sectiontitle">CreateAttachmentL ( const TDesC &amp;, RFile &amp;, const TDesC8 &amp;, TUint, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>CreateAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFileName</span>,</td></tr><tr><td colspan="3"> </td><td>RFile &amp;</td><td><span class="parameter">aAttachmentFile</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td><span class="parameter">aMimeType</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td><span class="parameter">aCharset</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<p class="p">To modify message attachments, use <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a>.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFileName</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aAttachmentFile</td><td>Unused  </td></tr><tr><td class="parameter">aMimeType</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aCharset</td><td>Unused  </td></tr><tr><td class="parameter">aStatus</td><td>Unused  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-08B02BE4-045E-3882-819C-0881A2ACE38C"><a name="GUID-08B02BE4-045E-3882-819C-0881A2ACE38C"><!-- --></a>
<a name="GUID-F3D54154-6255-3A77-B281-F96BF5F4E113"><!-- --></a><h3 class="sectiontitle">CreateMessageL ( TMsvId )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>CreateMessageL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aServiceId</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<p class="p">To create a new message, use <a class="xref" href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498">CImEmailOperation</a>.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aServiceId</td><td>Unused  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-30BA3059-FF43-3F44-B47B-367AB0128C7A"><a name="GUID-30BA3059-FF43-3F44-B47B-367AB0128C7A"><!-- --></a>
<h3 class="sectiontitle">DefaultServiceL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C TMsvId</td><td>DefaultServiceL</td><td>(</td><td>)</td><td>const [virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>KErrNotSupported Function not supported. </dd></dl></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-F0E40C74-ADC6-3521-9107-2329AC656CC7"><a name="GUID-F0E40C74-ADC6-3521-9107-2329AC656CC7"><!-- --></a>
<a name="GUID-3A9BA59B-1E6B-34F0-A47A-9C39823C7D80"><!-- --></a><h3 class="sectiontitle">Find ( const TDesC &amp;, TMsvPartList )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>TMsvPartList</td><td>Find</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aTextToFind</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvPartList</td><td><span class="parameter">aPartList</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Searches the specified message part(s) for the plain-text version of the text to be found.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aTextToFind</td><td>The plain-text version of the text to be found.  </td></tr><tr class="bg"><td class="parameter">aPartList</td><td>Indicates the message parts which should be searched.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>If the text was not found, or searching is unsupported, 0. If the text was found, a bitmask of the TMsvPartList IDs for each part in which the text was present. </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-133374AB-69C9-353F-A717-F49A0896DBB2"><a name="GUID-133374AB-69C9-353F-A717-F49A0896DBB2"><!-- --></a>
<a name="GUID-A40B6663-BF04-3E2D-B113-86E1D7A68FC9"><!-- --></a><h3 class="sectiontitle">ForwardL ( TMsvId, TMsvPartList, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>CMsvOperation *</td><td>ForwardL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aDestination</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvPartList</td><td><span class="parameter">aPartList</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aCompletionStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Creates an forwarded SMTP message from the current message context.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aDestination</td><td>Entry to which to assign the forwarded message.  </td></tr><tr class="bg"><td class="parameter">aPartList</td><td>Defines the parts that are to be copied from the original message into the forwarded message  </td></tr><tr><td class="parameter">aCompletionStatus</td><td>The request status to be completed when the operation has finished.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>If successful, this is an asynchronously completing forward message operation. If failed, this is a completed operation, with status set to the relevant error code. </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-E139F3A1-2FB6-3810-88EE-761ACC0A4FDB"><a name="GUID-E139F3A1-2FB6-3810-88EE-761ACC0A4FDB"><!-- --></a>
<a name="GUID-261A3317-4AD5-31E3-A2BA-83EEE3109BCF"><!-- --></a><h3 class="sectiontitle">HandleEntryEvent ( TMsvEntryEvent, TAny *, TAny *, TAny * )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>HandleEntryEvent</td><td>(</td><td>TMsvEntryEvent</td><td><span class="parameter">aEvent</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TAny</a> *</td><td><span class="parameter">aArg1</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TAny</a> *</td><td><span class="parameter">aArg2</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TAny</a> *</td><td><span class="parameter">aArg3</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-86EF8720-B11D-31DB-AA99-51EC64E028E5"><a name="GUID-86EF8720-B11D-31DB-AA99-51EC64E028E5"><!-- --></a>
<h3 class="sectiontitle">Imap4Settings (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C const <a class="xref xref apiRelation" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html">CImImap4Settings</a> &amp;</td><td>Imap4Settings</td><td>(</td><td>)</td><td>const </td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Gets the IMAP4 email service settings currently being used by the client MTM, if they exist.</p>
<p class="p">If no settings exist, then an empty settings object will be returned by this function. Settings will only exist if a prior call has been made to the <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-B43DAFC2-3AAE-37BA-AAB5-173B538413E3">RestoreL()</a> function when the client MTM was positioned over an IMAP4 service in the message store.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>IMAP4 service settings </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-0D719D79-BBDD-30F8-876E-89ADA897340B"><a name="GUID-0D719D79-BBDD-30F8-876E-89ADA897340B"><!-- --></a>
<a name="GUID-B8FCA9A9-85DA-367F-8E31-E8893AF82B2C"><!-- --></a><h3 class="sectiontitle">InvokeAsyncFunctionL ( TInt, const CMsvEntrySelection &amp;, TDes8 &amp;, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>CMsvOperation *</td><td>InvokeAsyncFunctionL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aFunctionId</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-6BC8851B-D913-3CE5-B343-5163661E8AD5.html">CMsvEntrySelection</a> &amp;</td><td><span class="parameter">aSelection</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp;</td><td><span class="parameter">aParameter</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aCompletionStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Invokes asynchronous IMAP-specific operations.</p>
<p class="p">This provides support for a large number of IMAP-specific functions, including operations to:</p>
<div class="p">
<ul class="ul">
<li class="li">
<p class="p">Connect and logon to a remote server</p>
</li>
<li class="li">
<p class="p">Synchronise headers</p>
</li>
<li class="li">
<p class="p">Subscribe to mailboxes</p>
</li>
<li class="li">
<p class="p">Populate messages</p>
</li>
<li class="li">
<p class="p">Copy messages</p>
</li>
<li class="li">
<p class="p">Move messages</p>
</li>
<li class="li">
<p class="p">Create messages</p>
</li>
<li class="li">
<p class="p">Set offline behaviour</p>
</li>
</ul>
</div>
<p class="p">For details of operations, see <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-66B8E85D-5101-3BC5-BF6A-4F0FB73CE15D">TImap4Cmds</a>.</p>
<div class="p">
</div>
<p class="p">See also: <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-66B8E85D-5101-3BC5-BF6A-4F0FB73CE15D">TImap4Cmds</a> </p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFunctionId</td><td>Specifies which operation to perform e.g. connect, copy new mail etc. The specific operations are defined by the TImap4Cmds enumeration.  </td></tr><tr class="bg"><td class="parameter">aSelection</td><td>A selection of messages. The use is dependant upon the command specified by aFunctionID.  </td></tr><tr><td class="parameter">aParameter</td><td>Use is dependant upon the command specified by aFunctionID  </td></tr><tr class="bg"><td class="parameter">aCompletionStatus</td><td>The status when the operation completes.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>If successful, this is an asynchronously completing operation. If failed, this is a completed operation, with status set to the relevant error code. </dd></dl></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">The selection of email to be moved or copied is empty</td></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">The specified operation is not recognised</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">IMCM</td><td class="panicvalue">33 MTM has no current context (debug builds only)</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-9BB08680-9B62-3D5C-BFB4-4928FDFE603D"><a name="GUID-9BB08680-9B62-3D5C-BFB4-4928FDFE603D"><!-- --></a>
<a name="GUID-1849BECB-C9D8-34EA-8B6E-805F2679AD04"><!-- --></a><h3 class="sectiontitle">InvokeSyncFunctionL ( TInt, const CMsvEntrySelection &amp;, TDes8 &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>InvokeSyncFunctionL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aFunctionId</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-6BC8851B-D913-3CE5-B343-5163661E8AD5.html">CMsvEntrySelection</a> &amp;</td><td><span class="parameter">aSelection</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-445B19E5-E2EE-32E2-8D6C-C7D6A9B3C507.html">TDes8</a> &amp;</td><td><span class="parameter">aParameter</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Invokes synchronous IMAP-specific operations.</p>
<div class="p">
</div>
<p class="p">See also: <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-ED975553-7010-344C-AD08-E8AA0756F823">KIMAP4MTMIsConnected</a> <a class="xref" href="GUID-C2B54202-9BE6-3172-AB3B-79BBB3ACEF99.html#GUID-47A0376A-7DE9-30CB-8B3E-8A0440C65ED3">KIMAP4MTMBusy</a> </p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFunctionId</td><td>ID of the requested function. Supported IDs are KIMAP4MTMIsConnected and KIMAP4MTMBusy.  </td></tr><tr class="bg"><td class="parameter">aSelection</td><td>Collection of function entries to invoke.  </td></tr><tr><td class="parameter">aParameter</td><td>Buffer containing input and output parameters. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function does not provide function specified by aFunctionId</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">IMCM</td><td class="panicvalue">33 MTM has no current context (debug builds only)</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-03574D25-50B5-3CDB-9361-6FCD8D102EE6"><a name="GUID-03574D25-50B5-3CDB-9361-6FCD8D102EE6"><!-- --></a>
<h3 class="sectiontitle">LoadMessageL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>LoadMessageL</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Loads the cache with the message data for the current message context.</p>
<p class="p">The current context should be an IMAP service or a message. If the current context is an IMAP service, then the function loads the service settings from the Central Repository. This is the same behaviour as <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-51143C41-A411-3F4F-BB84-D6231DBA0275">RestoreSettingsL()</a>. </p>
</div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-AD7C66DC-2446-3150-A566-5073645679D4"><a name="GUID-AD7C66DC-2446-3150-A566-5073645679D4"><!-- --></a>
<a name="GUID-6673DF8A-5F4E-3905-8267-6C0130C2D996"><!-- --></a><h3 class="sectiontitle">NewL ( CRegisteredMtmDll &amp;, CMsvSession &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html">CImap4ClientMtm</a> *</td><td>NewL</td><td>(</td><td>CRegisteredMtmDll &amp;</td><td><span class="parameter">aRegisteredMtmDll</span>,</td></tr><tr><td colspan="3"> </td><td>CMsvSession &amp;</td><td><span class="parameter">aSession</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[static]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">IMAP4 client MTM factory function.</p>
<p class="p">This function is not called directly by messaging clients. To create a client MTM object, use CClientMtmRegistry::NewMtmL().</p>
<p class="p">
</p><p class="p">See also: CClientMtmRegistry::NewMtmL() </p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aRegisteredMtmDll</td><td>MTM registry information  </td></tr><tr class="bg"><td class="parameter">aSession</td><td>Message server session  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>New IMAP4 client MTM object </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-BCA34BB0-D83A-3336-8338-51C633A67523"><a name="GUID-BCA34BB0-D83A-3336-8338-51C633A67523"><!-- --></a>
<a name="GUID-04E4DDF5-EC91-38C1-9F5E-FABBD759E087"><!-- --></a><h3 class="sectiontitle">QueryCapability ( TUid, TInt &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
</td><td>QueryCapability</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-530281E6-29FC-33F2-BC9B-610FBA389444.html">TUid</a></td><td><span class="parameter">aCapability</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a> &amp;</td><td><span class="parameter">aResponse</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Queries if the MTM supports a particular capability, specified by a UID.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aCapability</td><td>UID of capability to be queried. See MTMDEF.HRH for definition of UIDs.  </td></tr><tr class="bg"><td class="parameter">aResponse</td><td>Response value. The format of the response varies according to the capability.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>KErrNone: aCapability is a recognised value and a response is returned KErrNotSupported: aCapability is not a recognised value </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-AB74A4DA-E9CD-3795-8525-975E83B7F989"><a name="GUID-AB74A4DA-E9CD-3795-8525-975E83B7F989"><!-- --></a>
<a name="GUID-B4F0EAAB-D5DD-3C4A-BD1B-F4D6121DD671"><!-- --></a><h3 class="sectiontitle">QueueListL ( CMsvEntry &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C CImOperationQueueList *</td><td>QueueListL</td><td>(</td><td>CMsvEntry &amp;</td><td><span class="parameter">aServiceEntry</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-A6BDD58F-8E8A-34F4-8F0A-79C4D3CCD2EC"><a name="GUID-A6BDD58F-8E8A-34F4-8F0A-79C4D3CCD2EC"><!-- --></a>
<a name="GUID-71E02DD5-357C-3178-8AB7-A438C717726B"><!-- --></a><h3 class="sectiontitle">RemoveAddressee ( TInt )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>RemoveAddressee</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aIndex</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Message address function required by the base class, but not used for IMAP.</p>
<p class="p">To modify message address information, use the address functions in <a class="xref" href="GUID-C97C8B4F-C862-336C-85B0-BB116A26DE15.html#GUID-C97C8B4F-C862-336C-85B0-BB116A26DE15">CImHeader</a>.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aIndex</td><td>Index of address to be removed.  </td></tr></table></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-C817EA3F-113F-3494-A005-06B3F1E680D3"><a name="GUID-C817EA3F-113F-3494-A005-06B3F1E680D3"><!-- --></a>
<h3 class="sectiontitle">RemoveDefaultServiceL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>RemoveDefaultServiceL</td><td>(</td><td>)</td><td>[virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Unsupported client MTM base class function.</p>
<div class="p">
</div>
</div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">Function not supported.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-19E9124D-6C72-35A1-8306-36DB46947D1D"><a name="GUID-19E9124D-6C72-35A1-8306-36DB46947D1D"><!-- --></a>
<a name="GUID-777810AE-D10D-3CA4-A069-5FBE2F0535DA"><!-- --></a><h3 class="sectiontitle">ReplyL ( TMsvId, TMsvPartList, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>CMsvOperation *</td><td>ReplyL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aDestination</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvPartList</td><td><span class="parameter">aPartList</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aCompletionStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Creates an SMTP reply message to the current message context.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aDestination</td><td>Entry to which to assign the reply.  </td></tr><tr class="bg"><td class="parameter">aPartList</td><td>Defines the parts that are to be copied from the original message into the reply.  </td></tr><tr><td class="parameter">aCompletionStatus</td><td>The request status to be completed when the operation has finished.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>If successful, this is an asynchronously completing reply operation. If failed, this is a completed operation, with status set to the relevant error code. </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-B43DAFC2-3AAE-37BA-AAB5-173B538413E3"><a name="GUID-B43DAFC2-3AAE-37BA-AAB5-173B538413E3"><!-- --></a>
<h3 class="sectiontitle">RestoreL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>RestoreL</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-51143C41-A411-3F4F-BB84-D6231DBA0275"><a name="GUID-51143C41-A411-3F4F-BB84-D6231DBA0275"><!-- --></a>
<h3 class="sectiontitle">RestoreSettingsL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>RestoreSettingsL</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">If the current context of the client MTM is on an IMAP4 service, restores settings from the Central Repository.</p>
<p class="p">The restored settings can be accessed through the <a class="xref" href="GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html#GUID-86EF8720-B11D-31DB-AA99-51EC64E028E5">Imap4Settings()</a> function.</p>
<div class="p">
</div>
</div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">IMCM</td><td class="panicvalue">33 MTM has no current context (debug builds only)</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-1F149AF9-0BB1-3345-8C32-9C7859603087"><a name="GUID-1F149AF9-0BB1-3345-8C32-9C7859603087"><!-- --></a>
<h3 class="sectiontitle">SaveMessageL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>SaveMessageL</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Empty implementation of base class function.</p>
<p class="p">To edit an IMAP message, use <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a>. </p>
</div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-08575A13-24E1-35D8-B378-56BFC99FA069"><a name="GUID-08575A13-24E1-35D8-B378-56BFC99FA069"><!-- --></a>
<a name="GUID-708FC550-389A-3478-ACC2-A080552DBAC4"><!-- --></a><h3 class="sectiontitle">SetImap4SettingsL ( const CImImap4Settings &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>SetImap4SettingsL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-55F11633-988C-39D5-ADE7-23C4966FD995.html">CImImap4Settings</a> &amp;</td><td><span class="parameter">aSettings</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Sets the IMAP4 email service settings.</p>
<p class="p">This can be called at any time to override any current email settings (if they exist). However, new settings are only used by the MTM if they have been stored and then a new IMAP4 email session has been started: i.e. settings cannot be changed in mid-session.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aSettings</td><td>New IMAP4 service settings  </td></tr></table></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-D952EDAE-9DDB-31F6-8C4B-2DCF66E8319E"><a name="GUID-D952EDAE-9DDB-31F6-8C4B-2DCF66E8319E"><!-- --></a>
<h3 class="sectiontitle">StoreL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>StoreL</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-05268D43-66C9-37AD-921B-A3632E0CF6DC"><a name="GUID-05268D43-66C9-37AD-921B-A3632E0CF6DC"><!-- --></a>
<h3 class="sectiontitle">StoreSettingsL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>StoreSettingsL</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">If the current context of the client MTM is an IMAP4 service, stores settings in the Central Repository.</p>
<div class="p">
</div>
</div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">IMCM</td><td class="panicvalue">33 MTM has no current context (debug builds only)</td></tr><tr><td class="paniccode">IMCM</td><td class="panicvalue">44 Current context is not a service (debug builds only)</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-8BC6011B-AEF7-3B17-8B58-AC581376285B"><a name="GUID-8BC6011B-AEF7-3B17-8B58-AC581376285B"><!-- --></a>
<a name="GUID-1A1F343F-B0A5-3776-BCE1-6F53EC2879F7"><!-- --></a><h3 class="sectiontitle">UndoOffLineChangesL ( const CImOffLineOperation &amp;, TMsvId )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>UndoOffLineChangesL</td><td>(</td><td>const CImOffLineOperation &amp;</td><td><span class="parameter">aDeleted</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvId</td><td><span class="parameter">aFolderId</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[virtual]</td></tr></table></div><div><p>Reimplemented from <a class="xref xref apiRelation apiRelation cxxFunctionReimplemented" href="GUID-D66D9D87-856B-3129-BF71-40F96AC83039.html">MImUndoOffLineOperation::UndoOffLineChangesL(const CImOffLineOperation &amp;,TMsvId)</a></p></div><div class="section section apiDesc section apidesc">
<p class="p">This function is not supported.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aDeleted</td><td>Unused  </td></tr><tr class="bg"><td class="parameter">aFolderId</td><td>Unused  </td></tr></table></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-AECE12EA-5049-35FF-A733-640FCABE06E4"><a name="GUID-AECE12EA-5049-35FF-A733-640FCABE06E4"><!-- --></a>
<a name="GUID-474611EE-D983-378F-AD3D-54526BC8E8B8"><!-- --></a><h3 class="sectiontitle">ValidateMessage ( TUint )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>
</td><td>ValidateMessage</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td><span class="parameter">aPartList</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Validates the current message context.</p>
<p class="p">Only the message recipients and sender fields are checked for well-formed addresses.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aPartList</td><td>Indicates the value of the message parts for which validation is requested.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>Values of message parts.</dd></dl></div>
<div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">IMCM</td><td class="panicvalue">33 MTM has no current context (debug builds only)</td></tr></table></div></div>
</div>
</div></div><div class="footer"><hr /><div class="copy"> Nokia 2005.</div></div>
</div></div></div></div></div></div></div></div></div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-2DEC2EBD-EC94-3BAF-AD9D-8900FCD1CABE.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:14:10 GMT -->
</html>