<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:14:09 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta name="DC.Type" content="cxxClass" />
<meta name="DC.Title" content="CImEmailMessage" />
<meta name="abstract" content="" />
<meta name="description" content="" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="GUID-323E701E-EA22-3CC8-AE84-C16880608D44" />
<title>CImEmailMessage</title>
<meta name="keywords" content="api" /><link rel="stylesheet" type="text/css" href="css/nokiacxxref.css" />
<link href="css/s60/style.css" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp3.html" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category-cover_cpp3.html" rel="stylesheet" type="text/css" /></head>
<body id="GUID-323E701E-EA22-3CC8-AE84-C16880608D44"><a name="GUID-323E701E-EA22-3CC8-AE84-C16880608D44"><!-- --></a><div class="body"><div class="contentLeft prTxt">
<h1 class="sectiontitle">CImEmailMessage Class Reference</h1>
<div class="state state apiQualifier apiQualifier cxxClassDeclarationFile section include"><p>#include 
            
                    &lt;mw/miutmsg.h&gt;
                </p></div>
<div class="section signature"><table class="signature"><tr><td>class CImEmailMessage : public CMsgActive, public MImURITranslator</td></tr></table></div><div class="ph ph apiDefItem apiDefItem cxxClassDerivations section derivation"><h2 class="sectiontitle">Inherits from</h2><ul class="derivation derivation-root"><li class="derivation-depth-0 ">CImEmailMessage<ul class="derivation"><li class="derivation-depth-1 derivation-has-next"><a class="xref xref apiRelation apiBaseClassifier cxxClassBaseClass" href="GUID-5F49D8D0-4DB2-3B84-9AC6-96C759D895C0.html">CMsgActive</a><ul class="derivation"><li class="derivation-depth-2 derivation-has-next"><a class="xref xref apiRelation apiBaseClassifier cxxClassBaseClass" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive</a><ul class="derivation"><li class="derivation-depth-3 "><a class="xref xref apiRelation apiBaseClassifier cxxClassBaseClass" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase</a></li></ul></li><li class="derivation-depth-2 "><a class="xref xref apiRelation apiBaseClassifier cxxClassBaseClass" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive</a><ul class="derivation"><li class="derivation-depth-3 "><a class="xref xref apiRelation apiBaseClassifier cxxClassBaseClass" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase</a></li></ul></li></ul></li><li class="derivation-depth-1 "><a class="xref xref apiRelation apiBaseClassifier cxxClassBaseClass" href="GUID-8D20A302-652A-307F-AEC1-6696032FA33C.html">MImURITranslator</a></li></ul></li></ul></div>
<div class="section member-index"><table class="member-index"><thead><tr><th colspan="2">Public Member Enumerations</th></tr></thead><tbody><tr><td align="right" valign="top" class="code">enum</td><td><a href="#GUID-9B4F76BD-A4C7-342A-841B-B3422BD90DF7">TImAttachmentType</a> { <a href="#GUID-679A4B8A-8CA8-320F-A5EB-2F7C58ACB6FD">EAllAttachments</a>, <a href="#GUID-30684B57-6C88-37FE-A154-A02D89224148">EVCards</a>, <a href="#GUID-90FF0D3C-08BE-3829-B38E-436D7A2D6D15">EVCalendars</a>, <a href="#GUID-51CE539D-5455-3A52-8710-1E204214E927">EVEntries</a>, ..., <a href="#GUID-4A4D6122-CB7B-3E8E-956D-995821F21DA4">EICalendars</a> }</td></tr><tr class="bg"><td align="right" valign="top" class="code">enum</td><td><a href="#GUID-C7C022A3-3227-3CBF-9AA2-CE630015956A">TImEmailEntryType</a> { <a href="#GUID-CE8D9370-EBCE-38E3-A402-35C59A1CB184">EThisMessageOnly</a>, <a href="#GUID-637B7622-20A0-3CA4-ABE7-9F4E54C8194E">EThisMessageAndEmbeddedMessages</a> }</td></tr></tbody></table><table class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code"></td><td><a href="#GUID-B52E83C6-E11C-3AD2-B81E-92EF7DEC8E1A">~CImEmailMessage</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-755263D8-C404-3D87-928D-3AA8CA9D473D">AddAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, CMsvAttachment *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-0284F0A9-4707-39D4-839D-5DB7B44F7ED3">AddAttachmentL</a>(RFile &amp;, CMsvAttachment *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-974B4EFF-3122-3FD3-9233-D97EE280AD82">AddEntryAsAttachmentL</a>(TMsvId, CMsvAttachment *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-79CA9B4E-3F36-3F5A-AFBB-52CB0E2627D8">AddLinkedAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, CMsvAttachment *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-6A135956-34B7-3B9A-93CC-4D72958B19C9">AddRelatedPartL</a>(TMsvId, const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;, TMsvId, const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-24FF886F-B172-355C-8416-0973137EE2E5">AppendEntryAttachmentInfoL</a>()</td></tr><tr class="bg"><td align="right" class="code">const <a class="xref xref apiRelation" href="GUID-AAA13D1F-1BD7-3331-BB8C-11FA2795B53F.html">RPointerArray</a>&lt; CMsvAttachment &gt; &amp;</td><td><a href="#GUID-958CAD19-B360-3EFD-A55A-75904C59CCA3">AttachmentInfoSelection</a>()</td></tr><tr><td align="right" class="code">IMPORT_C MMsvAttachmentManager &amp;</td><td><a href="#GUID-D1E8E5F6-5F78-36F2-AF5C-D04DE7034B0E">AttachmentManager</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-17D2FC42-08C3-3C96-A72F-FFF8D1CA15AA">CheckEntryAndResetRemoveMessageL</a>(TMsvId)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-39F0D5AD-187E-376C-A33F-7FFAE2F7C65A">CheckEntryAndResetStoreMessageL</a>(TMsvId)</td></tr><tr class="bg"><td align="right" class="code">
<a class="xref xref apiRelation" href="GUID-79DEFCEC-D000-38F2-9FE5-C6729AC92C1D.html">CImMimeHeader</a> *</td><td><a href="#GUID-82E1CEC5-9687-36D5-841B-23BF92239909">ConvertToImMimeHeadersL</a>(CMsvMimeHeaders *)</td></tr><tr><td align="right" class="code">CMsvMimeHeaders *</td><td><a href="#GUID-3491F690-69A6-398A-A9A2-CA7EFE205704">ConvertToMsvMimeHeadersL</a>(<a class="xref xref apiRelation" href="GUID-79DEFCEC-D000-38F2-9FE5-C6729AC92C1D.html">CImMimeHeader</a> *)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-AE1CEB09-9DB0-3EBC-B7C0-EE084918239C">CreateAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, RFile &amp;, CMsvAttachment *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-2243F0C0-605C-380A-9791-5BFEE67B5623">DoGetAttachmentsListL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImAttachmentType</a>, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>)</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-802E29E9-BB09-3D72-9C6B-C107BD2CDA78">DoGetBodyTextInitL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>, CRichText &amp;, CParaFormatLayer &amp;, CCharFormatLayer &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-0C0D1990-4106-371F-AD93-751B8C3C5E0C">DoSetActive</a>(<a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">
TMsvId
</td><td><a href="#GUID-4FF3C1B1-1387-3402-9FE7-1C9F00562BFF">EmailEntryId</a>()</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-26015874-7A3A-3AC4-ACD4-A37785EF8463">FindFirstHTMLPageFileHandleL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-F244243F-935C-32EA-9099-40E06FE68C1E">FindFirstHTMLPageL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-1F482C3B-1B61-366B-9D08-9B5097CFF7A1">FindUniversalResourceIdentifierFileHandleL</a>(TMsvId, const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">virtual IMPORT_C void</td><td><a href="#GUID-E0EC7F3C-A630-39BF-BDE3-149C5667176C">FindUniversalResourceIdentifierL</a>(TMsvId, const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-B0694E13-1C06-3297-94EF-F79EE2BE5FB0">GetAttachmentsListL</a>(<a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;, TMsvId, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImAttachmentType</a>, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-54555D8E-002F-34BF-96DC-9F83D0825A1E">GetAttachmentsListL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImAttachmentType</a>, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-FA4311D0-87E6-3A6C-AF37-8000F06CDD47">GetBodyTextEntryIdL</a>(<a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;, TMsvId, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-EC353896-1C47-3D7C-96BC-EEE7B56D3F65">GetBodyTextEntryIdL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-CC3CD148-7F6E-3E2E-88B2-4730E95F38B2">GetBodyTextL</a>(<a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;, TMsvId, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>, CRichText &amp;, CParaFormatLayer &amp;, CCharFormatLayer &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-C66CB7B4-23F2-3D4F-BF67-EF3440BDE00F">GetBodyTextL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>, CRichText &amp;, CParaFormatLayer &amp;, CCharFormatLayer &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-513E7752-9F49-3565-936C-B01CE3FB745B">GetCharacterSetL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a> &amp;, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-5C4E5662-6B29-3929-AFDA-C25956FDFD79">GetMessageDigestEntriesL</a>(<a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;, TMsvId)</td></tr><tr><td align="right" class="code">virtual IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><a href="#GUID-F4D9EE5A-B093-3556-B8B0-A4021749B255">GetUniversalResourceIdentifierFileHandle</a>(TMsvId &amp;, RFile &amp;)</td></tr><tr class="bg"><td align="right" class="code">virtual IMPORT_C <a class="xref xref apiRelation" href="GUID-3D3D9CD7-C8FD-3F81-9CC5-1A71D4F9751E.html">HBufC</a> *</td><td><a href="#GUID-26131DCE-D86E-38B4-A02B-6E605060287C">GetUniversalResourceIdentifierL</a>(TMsvId &amp;, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">CImEmailMessage</a> *</td><td><a href="#GUID-3095284C-D445-30E7-BDC3-BA4737D92572">NewL</a>(CMsvEntry &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">CImEmailMessage</a> *</td><td><a href="#GUID-F438E199-E458-3B49-B274-32FDB0703A6A">NewLC</a>(CMsvEntry &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.html">CImPlainBodyText</a> *</td><td><a href="#GUID-928A6A91-BC31-3B41-B302-22F17CE924F7">OpenPlainBodyTextForReadL</a>(<a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a>, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C <a class="xref xref apiRelation" href="GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.html">CImPlainBodyText</a> *</td><td><a href="#GUID-B99E759E-E0D6-3A10-B81C-5BFCAF631B7D">OpenPlainBodyTextForWriteL</a>()</td></tr><tr><td align="right" class="code">IMPORT_C const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td><a href="#GUID-B3290295-7EEE-3B8B-8F14-166A118ABCDC">ProgressL</a>()</td></tr><tr class="bg"><td align="right" class="code">void</td><td><a href="#GUID-E200C456-EFF3-3EA2-BCD3-D2B887A7AAE0">RemoveAttachedMessageL</a>(TMsvAttachmentId, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">void</td><td><a href="#GUID-F262A7E1-D1AA-3497-ABCC-198907C8E089">RemoveAttachmentL</a>(TMsvAttachmentId, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C const <a class="xref xref apiRelation" href="GUID-6BC8851B-D913-3CE5-B343-5163661E8AD5.html">CMsvEntrySelection</a> &amp;</td><td><a href="#GUID-5703C3D1-349D-3F12-BF3E-0313D6729649">Selection</a>()</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-41FBEBD1-34C3-33A6-A0BE-A122B4ED23AE">SetCharacterSetL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-7E9C1C97-9CEB-353D-AF02-AF97D4BB9100">StoreBodyTextL</a>(TMsvId, CRichText &amp;, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-8418C768-63DE-3547-B4F1-6BB65D05C322">StoreBodyTextL</a>(TMsvId, CRichText &amp;, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;, <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a>)</td></tr><tr class="bg"><td align="right" class="code">IMPORT_C void</td><td><a href="#GUID-064DBAA5-6CF2-3E44-9601-41514133D761">StoreBodyTextWithMimeHeaderL</a>(TMsvId, CRichText &amp;, const <a class="xref xref apiRelation" href="GUID-79DEFCEC-D000-38F2-9FE5-C6729AC92C1D.html">CImMimeHeader</a> &amp;, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr></tbody></table><table class="member-index"><thead><tr><th colspan="2">Inherited Attributes</th></tr></thead><tbody><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassVariableInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::iStatus</a></td></tr></tbody></table><table class="member-index"><thead><tr><th colspan="2">Inherited Enumerations</th></tr></thead><tbody><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassEnumerationInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive:TPriority</a></td></tr></tbody></table><table class="member-index"><thead><tr><th colspan="2">Inherited Functions</th></tr></thead><tbody><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::CActive(TInt)</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::Cancel()</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::Deque()</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::Extension_(TUint,TAny *&amp;,TAny *)</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::IsActive()const</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::IsAdded()const</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::Priority()const</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::RunError(TInt)</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::SetActive()</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::SetPriority(TInt)</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-067293BF-B28C-3CEC-92F4-1351A795EA7F.html">CActive::~CActive()</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::CBase()</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::Delete(CBase *)</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint)</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TAny *)</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TLeave)</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TLeave,TUint)</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::operator new(TUint,TUint)</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-8F6FE089-E2A8-30F4-B67E-10F286347681.html">CBase::~CBase()</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-5F49D8D0-4DB2-3B84-9AC6-96C759D895C0.html">CMsgActive::CMsgActive(TInt)</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-5F49D8D0-4DB2-3B84-9AC6-96C759D895C0.html">CMsgActive::Complete(TInt)</a></td></tr><tr class="bg"><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-5F49D8D0-4DB2-3B84-9AC6-96C759D895C0.html">CMsgActive::Queue(TRequestStatus &amp;)</a></td></tr><tr><td> </td><td><a class="xref xref apiRelation apiRelation cxxClassFunctionInherited" href="GUID-5F49D8D0-4DB2-3B84-9AC6-96C759D895C0.html">CMsgActive::~CMsgActive()</a></td></tr></tbody></table></div><div class="section section apiDesc section apidesc"><h2 class="sectiontitle">Detailed Description</h2>
<p class="p">This class can be used to manipulate new emails that have been created using <a class="xref" href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498">CImEmailOperation</a> when composing a message.</p>
<p class="p">Use an instance of this class to add attachments, MHTML parts, body text, and existing messages to a new message before it is to be sent.</p>
<p class="p">This class can also be used to retrieve the body text, list of attachments, and embedded messages from emails that have been downloaded and stored within the message store.</p>
<p class="p">If the store_8bit_body_text flag in imcm.rss is enabled, an instance of this class can be used to retrieve the original body text character set for a particular message. It can also be used to override the original body text character set so it will be decoded in a new character set next time it is viewed.</p>
<p class="p">
</p><p class="p">See also: <a class="xref" href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498">CImEmailOperation</a></p>
</div>
<h2 class="sectiontitle">Member Enumeration Documentation</h2><div class="topic reference apiRef apiValue cxxEnumeration nested1" id="GUID-9B4F76BD-A4C7-342A-841B-B3422BD90DF7"><a name="GUID-9B4F76BD-A4C7-342A-841B-B3422BD90DF7"><!-- --></a>
<h3 class="sectiontitle">Enum TImAttachmentType</h3>
<div class="body refbody apiDetail apiValueDetail cxxEnumerationDetail section enumerationdetail"><div class="section section apiDesc section apidesc">
<p class="p">Flags to specify types of attachment. </p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxEnumerators section enumerators"><table class="enumerators"><thead><tr><th>Enumerator</th><th>Value</th><th>Description</th></tr></thead><tr><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-679A4B8A-8CA8-320F-A5EB-2F7C58ACB6FD"><span class="enumerator">EAllAttachments</span></a></td><td>0</td><td>
<p class="p">All attachments. </p>
</td></tr><tr class="bg"><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-30684B57-6C88-37FE-A154-A02D89224148"><span class="enumerator">EVCards</span></a></td><td></td><td>
<p class="p">VCards. </p>
</td></tr><tr><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-90FF0D3C-08BE-3829-B38E-436D7A2D6D15"><span class="enumerator">EVCalendars</span></a></td><td></td><td>
<p class="p">VCalendars. </p>
</td></tr><tr class="bg"><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-51CE539D-5455-3A52-8710-1E204214E927"><span class="enumerator">EVEntries</span></a></td><td></td><td>
<p class="p">VCards, VCalendars and ICalendars. </p>
</td></tr><tr><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-84B36637-913C-3FB2-9DCA-372C489A5CC2"><span class="enumerator">EEncrypted</span></a></td><td></td><td>
<p class="p">Encrypted. </p>
</td></tr><tr class="bg"><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-5586A1E8-5525-3C41-B241-0CF00CB88754"><span class="enumerator">ESigned</span></a></td><td></td><td>
<p class="p">Signed. </p>
</td></tr><tr><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-D712E394-FB5F-3663-83CE-AD983417F3AE"><span class="enumerator">ESecure</span></a></td><td></td><td>
<p class="p">Secure. </p>
</td></tr><tr class="bg"><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-4A4D6122-CB7B-3E8E-956D-995821F21DA4"><span class="enumerator">EICalendars</span></a></td><td></td><td>
<p class="p">ICalendars. </p>
</td></tr></table></div>
</div>
</div>
<div class="topic reference apiRef apiValue cxxEnumeration nested1" id="GUID-C7C022A3-3227-3CBF-9AA2-CE630015956A"><a name="GUID-C7C022A3-3227-3CBF-9AA2-CE630015956A"><!-- --></a>
<h3 class="sectiontitle">Enum TImEmailEntryType</h3>
<div class="body refbody apiDetail apiValueDetail cxxEnumerationDetail section enumerationdetail"><div class="section section apiDesc section apidesc">
<p class="p">Flags that specify to process on any messages embedded in this message. </p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxEnumerators section enumerators"><table class="enumerators"><thead><tr><th>Enumerator</th><th>Value</th><th>Description</th></tr></thead><tr><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-CE8D9370-EBCE-38E3-A402-35C59A1CB184"><span class="enumerator">EThisMessageOnly</span></a></td><td></td><td>
<p class="p">Do not process embedded messages. </p>
</td></tr><tr class="bg"><td class="ph ph apiDefItem apiDefItem cxxEnumerator"><a name="GUID-637B7622-20A0-3CA4-ABE7-9F4E54C8194E"><span class="enumerator">EThisMessageAndEmbeddedMessages</span></a></td><td></td><td>
<p class="p">Process embedded messages. </p>
</td></tr></table></div>
</div>
</div>
<h2 class="sectiontitle">Constructor &amp; Destructor Documentation</h2><div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-B52E83C6-E11C-3AD2-B81E-92EF7DEC8E1A"><a name="GUID-B52E83C6-E11C-3AD2-B81E-92EF7DEC8E1A"><!-- --></a>
<h3 class="sectiontitle">~CImEmailMessage (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C</td><td>~CImEmailMessage</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Destructor. </p>
</div>
</div>
</div>
<h2 class="sectiontitle">Member Function Documentation</h2><div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-755263D8-C404-3D87-928D-3AA8CA9D473D"><a name="GUID-755263D8-C404-3D87-928D-3AA8CA9D473D"><!-- --></a>
<a name="GUID-D0672277-51C3-3E3E-8D32-5B4C126C2BBA"><!-- --></a><h3 class="sectiontitle">AddAttachmentL ( const TDesC &amp;, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFilePath</span>,</td></tr><tr><td colspan="3"> </td><td>CMsvAttachment *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-0284F0A9-4707-39D4-839D-5DB7B44F7ED3"><a name="GUID-0284F0A9-4707-39D4-839D-5DB7B44F7ED3"><!-- --></a>
<h3 class="sectiontitle">AddAttachmentL ( RFile &amp;, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddAttachmentL</td><td>(</td><td>RFile &amp;</td><td><span class="parameter">aFileHandle</span>,</td></tr><tr><td colspan="3"> </td><td>CMsvAttachment *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-974B4EFF-3122-3FD3-9233-D97EE280AD82"><a name="GUID-974B4EFF-3122-3FD3-9233-D97EE280AD82"><!-- --></a>
<a name="GUID-775EB457-595C-3006-BC5D-58F204339694"><!-- --></a><h3 class="sectiontitle">AddEntryAsAttachmentL ( TMsvId, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddEntryAsAttachmentL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aAttachmentEntryId</span>,</td></tr><tr><td colspan="3"> </td><td>CMsvAttachment *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-79CA9B4E-3F36-3F5A-AFBB-52CB0E2627D8"><a name="GUID-79CA9B4E-3F36-3F5A-AFBB-52CB0E2627D8"><!-- --></a>
<a name="GUID-50D19998-95C9-39CD-B2D9-9310A8A3FF9A"><!-- --></a><h3 class="sectiontitle">AddLinkedAttachmentL ( const TDesC &amp;, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddLinkedAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFilePath</span>,</td></tr><tr><td colspan="3"> </td><td>CMsvAttachment *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-6A135956-34B7-3B9A-93CC-4D72958B19C9"><a name="GUID-6A135956-34B7-3B9A-93CC-4D72958B19C9"><!-- --></a>
<a name="GUID-39B0687B-2456-32E4-A0D3-7D9701DF2FED"><!-- --></a><h3 class="sectiontitle">AddRelatedPartL ( TMsvId, const TDesC &amp;, TRequestStatus &amp;, TMsvId, const TDesC8 &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>AddRelatedPartL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aAttachmentFullName</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvId</td><td><span class="parameter">aRelatedPartId</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td><span class="parameter">aContentId</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Adds a file to a specified message as a MIME multipart/related part. After the call has completed, calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-B3290295-7EEE-3B8B-8F14-166A118ABCDC">ProgressL()</a> will return the Id of the newly created related part entry.</p>
<p class="p">Used when adding specific parts of an MHTML message, such as inline images that are referenced as MHTML anchors within the HTML part of a message. Refer to RFC 2557 - "MIME Encapsulation of Aggregate Documents, such as HTML (MHTML)" for information about MHTML email messages.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">This function should only be used on messages created using <a class="xref" href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498">CImEmailOperation</a>.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that the related part will be added to. The entry must be of type KUidMsvMessageEntry. </td></tr><tr class="bg"><td class="parameter">aAttachmentFullName</td><td>The full path and file name of the related part file to be copied to the message store. If the file cannot be located, this call completes with KErrNotFound. </td></tr><tr><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr><tr class="bg"><td class="parameter">aRelatedPartId</td><td>The entry Id of the MHTML message part that the file being added is referenced from. </td></tr><tr><td class="parameter">aContentId</td><td>The Content-Id of the related part. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-24FF886F-B172-355C-8416-0973137EE2E5"><a name="GUID-24FF886F-B172-355C-8416-0973137EE2E5"><!-- --></a>
<h3 class="sectiontitle">AppendEntryAttachmentInfoL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AppendEntryAttachmentInfoL</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-958CAD19-B360-3EFD-A55A-75904C59CCA3"><a name="GUID-958CAD19-B360-3EFD-A55A-75904C59CCA3"><!-- --></a>
<h3 class="sectiontitle">AttachmentInfoSelection (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>const <a class="xref xref apiRelation" href="GUID-AAA13D1F-1BD7-3331-BB8C-11FA2795B53F.html">RPointerArray</a>&lt; CMsvAttachment &gt; &amp;</td><td>AttachmentInfoSelection</td><td>(</td><td>)</td><td>const </td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns a list of attachment information pointers (CMsvAttachment) populated by a call to <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-B0694E13-1C06-3297-94EF-F79EE2BE5FB0">GetAttachmentsListL()</a>.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">The attachment information list must first be populated by calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-B0694E13-1C06-3297-94EF-F79EE2BE5FB0">GetAttachmentsListL()</a>.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>An array of attachment information objects (CMsvAttachment) representing the attachments contained within a particular message specified in the call to GetAttachmentsListL(). </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-D1E8E5F6-5F78-36F2-AF5C-D04DE7034B0E"><a name="GUID-D1E8E5F6-5F78-36F2-AF5C-D04DE7034B0E"><!-- --></a>
<h3 class="sectiontitle">AttachmentManager (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C MMsvAttachmentManager &amp;</td><td>AttachmentManager</td><td>(</td><td>)</td><td>const </td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-17D2FC42-08C3-3C96-A72F-FFF8D1CA15AA"><a name="GUID-17D2FC42-08C3-3C96-A72F-FFF8D1CA15AA"><!-- --></a>
<a name="GUID-B28BA719-8343-368E-8090-E696982428DB"><!-- --></a><h3 class="sectiontitle">CheckEntryAndResetRemoveMessageL ( TMsvId )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>CheckEntryAndResetRemoveMessageL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-39F0D5AD-187E-376C-A33F-7FFAE2F7C65A"><a name="GUID-39F0D5AD-187E-376C-A33F-7FFAE2F7C65A"><!-- --></a>
<a name="GUID-8B1250DA-DB77-3324-928A-F369C5231806"><!-- --></a><h3 class="sectiontitle">CheckEntryAndResetStoreMessageL ( TMsvId )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>CheckEntryAndResetStoreMessageL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-82E1CEC5-9687-36D5-841B-23BF92239909"><a name="GUID-82E1CEC5-9687-36D5-841B-23BF92239909"><!-- --></a>
<a name="GUID-C9B99A10-05BE-38B7-8286-989F08D43FAD"><!-- --></a><h3 class="sectiontitle">ConvertToImMimeHeadersL ( CMsvMimeHeaders * )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-79DEFCEC-D000-38F2-9FE5-C6729AC92C1D.html">CImMimeHeader</a> *</td><td>ConvertToImMimeHeadersL</td><td>(</td><td>CMsvMimeHeaders *</td><td><span class="parameter">aMimeHeaders</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-3491F690-69A6-398A-A9A2-CA7EFE205704"><a name="GUID-3491F690-69A6-398A-A9A2-CA7EFE205704"><!-- --></a>
<a name="GUID-4D3D8839-10EF-3FC3-9E91-B0BF5EE255C7"><!-- --></a><h3 class="sectiontitle">ConvertToMsvMimeHeadersL ( CImMimeHeader * )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>CMsvMimeHeaders *</td><td>ConvertToMsvMimeHeadersL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-79DEFCEC-D000-38F2-9FE5-C6729AC92C1D.html">CImMimeHeader</a> *</td><td><span class="parameter">aMimeHeader</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-AE1CEB09-9DB0-3EBC-B7C0-EE084918239C"><a name="GUID-AE1CEB09-9DB0-3EBC-B7C0-EE084918239C"><!-- --></a>
<a name="GUID-A1F51F1E-D594-33EA-A377-5AEB1292A4A0"><!-- --></a><h3 class="sectiontitle">CreateAttachmentL ( const TDesC &amp;, RFile &amp;, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>CreateAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFileName</span>,</td></tr><tr><td colspan="3"> </td><td>RFile &amp;</td><td><span class="parameter">aAttachmentFile</span>,</td></tr><tr><td colspan="3"> </td><td>CMsvAttachment *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-2243F0C0-605C-380A-9791-5BFEE67B5623"><a name="GUID-2243F0C0-605C-380A-9791-5BFEE67B5623"><!-- --></a>
<a name="GUID-FEF5E0EC-DB9F-391A-84EE-2E4EF1639C0B"><!-- --></a><h3 class="sectiontitle">DoGetAttachmentsListL ( TMsvId, TImAttachmentType, TImEmailEntryType )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>DoGetAttachmentsListL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImAttachmentType</a></td><td><span class="parameter">aAttachmentType</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-802E29E9-BB09-3D72-9C6B-C107BD2CDA78"><a name="GUID-802E29E9-BB09-3D72-9C6B-C107BD2CDA78"><!-- --></a>
<a name="GUID-CC6C1B52-94B3-3B24-8034-EE61F0858BFA"><!-- --></a><h3 class="sectiontitle">DoGetBodyTextInitL ( TMsvId, TImEmailEntryType, CRichText &amp;, CParaFormatLayer &amp;, CCharFormatLayer &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>DoGetBodyTextInitL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span>,</td></tr><tr><td colspan="3"> </td><td>CRichText &amp;</td><td><span class="parameter">aRichText</span>,</td></tr><tr><td colspan="3"> </td><td>CParaFormatLayer &amp;</td><td><span class="parameter">aParaLayer</span>,</td></tr><tr><td colspan="3"> </td><td>CCharFormatLayer &amp;</td><td><span class="parameter">aCharLayer</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-0C0D1990-4106-371F-AD93-751B8C3C5E0C"><a name="GUID-0C0D1990-4106-371F-AD93-751B8C3C5E0C"><!-- --></a>
<a name="GUID-07C0E3C5-89C2-397A-BC54-3522509B2F8D"><!-- --></a><h3 class="sectiontitle">DoSetActive ( TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>DoSetActive</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-4FF3C1B1-1387-3402-9FE7-1C9F00562BFF"><a name="GUID-4FF3C1B1-1387-3402-9FE7-1C9F00562BFF"><!-- --></a>
<h3 class="sectiontitle">EmailEntryId (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
TMsvId
</td><td>EmailEntryId</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-26015874-7A3A-3AC4-ACD4-A37785EF8463"><a name="GUID-26015874-7A3A-3AC4-ACD4-A37785EF8463"><!-- --></a>
<a name="GUID-12254C94-3D3C-3485-8489-A3F090C4C119"><!-- --></a><h3 class="sectiontitle">FindFirstHTMLPageFileHandleL ( TMsvId, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>FindFirstHTMLPageFileHandleL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously searches for the starting MHTML part embedded in a multipart/related email message.</p>
<p class="p">Used when retrieving specific parts of an MHTML message, such as inline images that are referenced as MHTML anchors within the HTML part of a message. Refer to RFC 2557 - "MIME Encapsulation of Aggregate Documents, such as HTML (MHTML)" for information about MHTML email messages.</p>
<p class="p">If the starting MHTML part cannot be located, then the first HTML part that occurs within the multipart/related message is located.</p>
<p class="p">The result of the search is retrieved by calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-F4D9EE5A-B093-3556-B8B0-A4021749B255">GetUniversalResourceIdentifierFileHandle()</a> after this methods has completed.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that will be searched. </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-F244243F-935C-32EA-9099-40E06FE68C1E"><a name="GUID-F244243F-935C-32EA-9099-40E06FE68C1E"><!-- --></a>
<a name="GUID-85A27605-3F0F-310B-BEB3-6C23CB634EF5"><!-- --></a><h3 class="sectiontitle">FindFirstHTMLPageL ( TMsvId, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>FindFirstHTMLPageL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously searches for the starting MHTML part embedded in a multipart/related email message.</p>
<p class="p">Used when retrieving specific parts of an MHTML message, such as inline images that are referenced as MHTML anchors within the HTML part of a message. Refer to RFC 2557 - "MIME Encapsulation of Aggregate Documents, such as HTML (MHTML)" for information about MHTML email messages.</p>
<p class="p">If the starting MHTML part cannot be located, then the first HTML part that occurs within the multipart/related message is located.</p>
<p class="p">The result of the search is retrieved by calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-26131DCE-D86E-38B4-A02B-6E605060287C">GetUniversalResourceIdentifierL()</a> after this methods has completed.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that will be searched. </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-1F482C3B-1B61-366B-9D08-9B5097CFF7A1"><a name="GUID-1F482C3B-1B61-366B-9D08-9B5097CFF7A1"><!-- --></a>
<a name="GUID-1D6333FC-25ED-37A0-8FAF-AA17C74587BB"><!-- --></a><h3 class="sectiontitle">FindUniversalResourceIdentifierFileHandleL ( TMsvId, const TDesC &amp;, const TDesC &amp;, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>FindUniversalResourceIdentifierFileHandleL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aBase</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aURI</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[virtual]</td></tr></table></div><div><p>Reimplemented from <a class="xref xref apiRelation apiRelation cxxFunctionReimplemented" href="GUID-8D20A302-652A-307F-AEC1-6696032FA33C.html">MImURITranslator::FindUniversalResourceIdentifierFileHandleL(TMsvId,const TDesC &amp;,const TDesC &amp;,TRequestStatus &amp;)</a></p></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously searches a message entry for an MHTML URI, and resolves it to the message entry that contains the message part specified by the URI.</p>
<p class="p">Used when retrieving specific parts of an MHTML message, such as inline images that are referenced as MHTML anchors within the HTML part of a message. Refer to RFC 2557 - "MIME Encapsulation of Aggregate Documents, such as HTML (MHTML)" for information about MHTML email messages.</p>
<p class="p">The result of the search is retrieved by calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-F4D9EE5A-B093-3556-B8B0-A4021749B255">GetUniversalResourceIdentifierFileHandle()</a> after this method has completed.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The message Id of the body part that is to be searched for the URI. In the first instance, this value should be the starting MHTML entry Id that was located by calling FindFirstHTMLPageFileHandleL(). </td></tr><tr class="bg"><td class="parameter">aBase</td><td>The base URI to use when searching for aURI if aURI is relative. If aBase is empty, and aURI is relative, then the Content-location MIME header contained within the HTML part specified by aMessageId is used as a base. If the Content-location header does not exist or is not absolute, then just the relative aURI is searched for. </td></tr><tr><td class="parameter">aURI</td><td>The absolute or relative URI to resolve. If aURI is absolute, then aBase is ignored and this method completes faster. If aURI is relative, then aBase is used as a base to resolve the relative URI. If aBase is empty and aURI is relative, then the Content-location MIME header contained within the HTML part specified by aMessageId is used as the base. If the Content-location header does not exist or is not absolute, then just the relative aURI is searched for. </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-E0EC7F3C-A630-39BF-BDE3-149C5667176C"><a name="GUID-E0EC7F3C-A630-39BF-BDE3-149C5667176C"><!-- --></a>
<a name="GUID-1442E10B-BF3B-335C-BBCE-C8F0CE377E12"><!-- --></a><h3 class="sectiontitle">FindUniversalResourceIdentifierL ( TMsvId, const TDesC &amp;, const TDesC &amp;, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>FindUniversalResourceIdentifierL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aBase</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aURI</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[virtual]</td></tr></table></div><div><p>Reimplemented from <a class="xref xref apiRelation apiRelation cxxFunctionReimplemented" href="GUID-8D20A302-652A-307F-AEC1-6696032FA33C.html">MImURITranslator::FindUniversalResourceIdentifierL(TMsvId,const TDesC &amp;,const TDesC &amp;,TRequestStatus &amp;)</a></p></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously searches a message entry for an MHTML URI, and resolves it to the message entry that contains the message part specified by the URI.</p>
<p class="p">Used when retrieving specific parts of an MHTML message, such as inline images that are referenced as MHTML anchors within the HTML part of a message. Refer to RFC 2557 - "MIME Encapsulation of Aggregate Documents, such as HTML (MHTML)" for information about MHTML email messages.</p>
<p class="p">The result of the search is retrieved by calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-26131DCE-D86E-38B4-A02B-6E605060287C">GetUniversalResourceIdentifierL()</a> after this method has completed.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The message Id of the body part that is to be searched for the URI. In the first instance, this value should be the starting MHTML entry Id that was located by calling FindFirstHTMLPageL(). </td></tr><tr class="bg"><td class="parameter">aBase</td><td>The base URI to use when searching for aURI if aURI is relative. If aBase is empty, and aURI is relative, then the Content-location MIME header contained within the HTML part specified by aMessageId is used as a base. If the Content-location header does not exist or is not absolute, then just the relative aURI is searched for. </td></tr><tr><td class="parameter">aURI</td><td>The absolute or relative URI to resolve. If aURI is absolute, then aBase is ignored and this method completes faster. If aURI is relative, then aBase is used as a base to resolve the relative URI. If aBase is empty and aURI is relative, then the Content-location MIME header contained within the HTML part specified by aMessageId is used as the base. If the Content-location header does not exist or is not absolute, then just the relative aURI is searched for. </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-B0694E13-1C06-3297-94EF-F79EE2BE5FB0"><a name="GUID-B0694E13-1C06-3297-94EF-F79EE2BE5FB0"><!-- --></a>
<a name="GUID-E677DC5E-A50A-377A-9B79-775214E56AE3"><!-- --></a><h3 class="sectiontitle">GetAttachmentsListL ( TRequestStatus &amp;, TMsvId, TImAttachmentType, TImEmailEntryType )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>GetAttachmentsListL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImAttachmentType</a></td><td><span class="parameter">aAttachmentType</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously populates a list containing all the attachment entry Ids found that are of a specified type belonging to the specified message. After this function has completed, call AttachmentSelection() to get the list of found attachments.</p>
<p class="p">If the email's character set has been overridden by a prior call to <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-41FBEBD1-34C3-33A6-A0BE-A122B4ED23AE">SetCharacterSetL()</a>, the attachment names are decoded with the new character set.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr><tr class="bg"><td class="parameter">aMessageId</td><td>The entry Id of the email message that the body text is to be retrieved from. The entry must be of type KUidMsvMessageEntry. </td></tr><tr><td class="parameter">aAttachmentType</td><td>The type of attachment to find. Supported attachment types are EAllAttachments, which would get all attachments for the message, EVCards that would get all attachments that are VCards, EVCalendars that would get VCalenders, EICalendar that would get ICalendars, and EVEntries which would get attachments that are either VCards, VCalendars or ICalendars. EEncrypted, ESigned and ESecure are currently not supported. </td></tr><tr class="bg"><td class="parameter">aEntryType</td><td>Specifies whether to search just the email message (EThisMessageOnly), or to search within any embedded messages it may contain (EThisMessageAndEmbeddedMessages). </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">aEntryType is not EThisMessageOnly or EThisMessageAndEmbeddedMessages.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-54555D8E-002F-34BF-96DC-9F83D0825A1E"><a name="GUID-54555D8E-002F-34BF-96DC-9F83D0825A1E"><!-- --></a>
<h3 class="sectiontitle">GetAttachmentsListL ( TMsvId, TImAttachmentType, TImEmailEntryType )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>GetAttachmentsListL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImAttachmentType</a></td><td><span class="parameter">aAttachmentType</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Populates a list containing all the attachment entry Ids found that are of a specified type belonging to the specified message. After this function has completed, call AttachmentSelection() to get the list of found attachments.</p>
<p class="p">If the email's character set has been overridden by a prior call to <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-41FBEBD1-34C3-33A6-A0BE-A122B4ED23AE">SetCharacterSetL()</a>, the attachment names are decoded with the new character set.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that the attachment list is to be populated. The entry must be of type KUidMsvMessageEntry. </td></tr><tr class="bg"><td class="parameter">aAttachmentType</td><td>The type of attachment to find. Supported attachment types are EAllAttachments, which would get all attachments for the message, EVCards that would get all attachments that are VCards, EVCalendars that would get VCalenders, EICalendar that would get ICalendars, and EVEntries which would get attachments that are either VCards, VCalendars or ICalendars. EEncrypted, ESigned and ESecure are currently not supported. </td></tr><tr><td class="parameter">aEntryType</td><td>Specifies whether to search just the email message (EThisMessageOnly), or to search within any embedded messages it may contain (EThisMessageAndEmbeddedMessages). </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">aEntryType is not EThisMessageOnly or EThisMessageAndEmbeddedMessages.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-FA4311D0-87E6-3A6C-AF37-8000F06CDD47"><a name="GUID-FA4311D0-87E6-3A6C-AF37-8000F06CDD47"><!-- --></a>
<a name="GUID-1EF75CB8-C147-30A1-8B06-9F6D50C3A352"><!-- --></a><h3 class="sectiontitle">GetBodyTextEntryIdL ( TRequestStatus &amp;, TMsvId, TImEmailEntryType )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>GetBodyTextEntryIdL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-EC353896-1C47-3D7C-96BC-EEE7B56D3F65"><a name="GUID-EC353896-1C47-3D7C-96BC-EEE7B56D3F65"><!-- --></a>
<h3 class="sectiontitle">GetBodyTextEntryIdL ( TMsvId, TImEmailEntryType )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>GetBodyTextEntryIdL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-CC3CD148-7F6E-3E2E-88B2-4730E95F38B2"><a name="GUID-CC3CD148-7F6E-3E2E-88B2-4730E95F38B2"><!-- --></a>
<a name="GUID-57CA3F50-33EA-359B-AABB-4E4E15AF2A18"><!-- --></a><h3 class="sectiontitle">GetBodyTextL ( TRequestStatus &amp;, TMsvId, TImEmailEntryType, CRichText &amp;, CParaFormatLayer &amp;, CCharFormatLayer &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>GetBodyTextL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span>,</td></tr><tr><td colspan="3"> </td><td>CRichText &amp;</td><td><span class="parameter">aRichText</span>,</td></tr><tr><td colspan="3"> </td><td>CParaFormatLayer &amp;</td><td><span class="parameter">aParaLayer</span>,</td></tr><tr><td colspan="3"> </td><td>CCharFormatLayer &amp;</td><td><span class="parameter">aCharLayer</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously retrieves the body text for a specified message. If the email's character set has been overridden by a prior call to <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-41FBEBD1-34C3-33A6-A0BE-A122B4ED23AE">SetCharacterSetL()</a>, the body text is decoded with the new character set before it is inserted into the rich text object. A list containing the entry Ids for each body text part within the specified message is created during this call. The list can be retrieved after this call has completed by calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-5703C3D1-349D-3F12-BF3E-0313D6729649">Selection()</a>.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr><tr class="bg"><td class="parameter">aMessageId</td><td>The entry Id of the email message that the body text is to be retrieved from. The entry must be of type KUidMsvMessageEntry. </td></tr><tr><td class="parameter">aEntryType</td><td>Specifies whether to search just the email message (EThisMessageOnly), or to search within any embedded messages it may contain (EThisMessageAndEmbeddedMessages). </td></tr><tr class="bg"><td class="parameter">aRichText</td><td>Upon completion, returns the aRichText object that contains the message body text of all text parts found for the message entry specified by aMessageId. If the body text was not found, then aRichText will be unchanged. </td></tr><tr><td class="parameter">aParaLayer</td><td>Paragraph format layer for the rich text object specified by aRichText. </td></tr><tr class="bg"><td class="parameter">aCharLayer</td><td>Character format layer for the rich text object specified by aRichText. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-C66CB7B4-23F2-3D4F-BF67-EF3440BDE00F"><a name="GUID-C66CB7B4-23F2-3D4F-BF67-EF3440BDE00F"><!-- --></a>
<h3 class="sectiontitle">GetBodyTextL ( TMsvId, TImEmailEntryType, CRichText &amp;, CParaFormatLayer &amp;, CCharFormatLayer &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>GetBodyTextL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span>,</td></tr><tr><td colspan="3"> </td><td>CRichText &amp;</td><td><span class="parameter">aRichText</span>,</td></tr><tr><td colspan="3"> </td><td>CParaFormatLayer &amp;</td><td><span class="parameter">aParaLayer</span>,</td></tr><tr><td colspan="3"> </td><td>CCharFormatLayer &amp;</td><td><span class="parameter">aCharLayer</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Retrieves the body text for a specified message. If the email's character set has been overridden by a prior call to <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-41FBEBD1-34C3-33A6-A0BE-A122B4ED23AE">SetCharacterSetL()</a>, the body text is decoded with the new character set before it is inserted into the rich text object. A list containing the entry Ids for each body text part within the specified message is created during this call. The list can be retrieved by calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-5703C3D1-349D-3F12-BF3E-0313D6729649">Selection()</a>.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that the body text is to be retrieved from. The entry must be of type KUidMsvMessageEntry. </td></tr><tr class="bg"><td class="parameter">aEntryType</td><td>Specifies whether to search just the email message (EThisMessageOnly), or to search within any embedded messages it may contain (EThisMessageAndEmbeddedMessages). </td></tr><tr><td class="parameter">aRichText</td><td>Returns the aRichText object that contains the message body text of all text parts found for the message entry specified by aMessageId. If the body text was not found, then aRichText will be unchanged. </td></tr><tr class="bg"><td class="parameter">aParaLayer</td><td>Paragraph format layer for the rich text object specified by aRichText. </td></tr><tr><td class="parameter">aCharLayer</td><td>Character format layer for the rich text object specified by aRichText. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-513E7752-9F49-3565-936C-B01CE3FB745B"><a name="GUID-513E7752-9F49-3565-936C-B01CE3FB745B"><!-- --></a>
<a name="GUID-C98F4157-3352-3F5E-BC79-8A73D7BE0FEA"><!-- --></a><h3 class="sectiontitle">GetCharacterSetL ( TMsvId, TUint &amp;, TBool &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>GetCharacterSetL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a> &amp;</td><td><span class="parameter">aCharacterSetId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> &amp;</td><td><span class="parameter">aOverride</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns the character set Id that the body text will be decoded in when it is returned in the call to <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-CC3CD148-7F6E-3E2E-88B2-4730E95F38B2">GetBodyTextL()</a>. It also indicates whether the original character set has been overridden by calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-41FBEBD1-34C3-33A6-A0BE-A122B4ED23AE">SetCharacterSetL()</a>.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">The store_8bit_body_text flag in imcm.rss should be enabled. This is done at build time by the manufacturer.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that the character set Id is to be retrieved from. The entry must be of type KUidMsvMessageEntry. </td></tr><tr class="bg"><td class="parameter">aCharacterSetId</td><td>Returns the character set Id that the message will be displayed when it is viewed. If aCharacterSetId is zero and aOverride is EFalse, the store_8bit_body_text flag in imcm.rss has not been enabled. </td></tr><tr><td class="parameter">aOverride</td><td>Returns ETrue if the message's original character set has been overridden (changed) via the call to SetCharacterSetL(). If aCharacterSetId is zero and aOverride is EFalse, the store_8bit_body_text flag in imcm.rss has not been enabled. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-5C4E5662-6B29-3929-AFDA-C25956FDFD79"><a name="GUID-5C4E5662-6B29-3929-AFDA-C25956FDFD79"><!-- --></a>
<a name="GUID-F0438477-64E4-373F-90E4-BFF2D61210A0"><!-- --></a><h3 class="sectiontitle">GetMessageDigestEntriesL ( TRequestStatus &amp;, TMsvId )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>GetMessageDigestEntriesL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span>,</td></tr><tr><td colspan="3"> </td><td>TMsvId</td><td><span class="parameter">aMessageId</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously populates a list of embedded message entries contained within the specified message. Note that any embedded messages within embedded messages are not included in the list. Call <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-5703C3D1-349D-3F12-BF3E-0313D6729649">Selection()</a> to get the results of the search after it has completed.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr><tr class="bg"><td class="parameter">aMessageId</td><td>The entry Id of the email message that will be searched for embedded messages. The entry must be of type KUidMsvMessageEntry. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-F4D9EE5A-B093-3556-B8B0-A4021749B255"><a name="GUID-F4D9EE5A-B093-3556-B8B0-A4021749B255"><!-- --></a>
<a name="GUID-EFE905B2-6060-3ED6-96F9-F185778136FB"><!-- --></a><h3 class="sectiontitle">GetUniversalResourceIdentifierFileHandle ( TMsvId &amp;, RFile &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td>GetUniversalResourceIdentifierFileHandle</td><td>(</td><td>TMsvId &amp;</td><td><span class="parameter">aLinkedEntryId</span>,</td></tr><tr><td colspan="3"> </td><td>RFile &amp;</td><td><span class="parameter">aFile</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">const [virtual]</td></tr></table></div><div><p>Reimplemented from <a class="xref xref apiRelation apiRelation cxxFunctionReimplemented" href="GUID-8D20A302-652A-307F-AEC1-6696032FA33C.html">MImURITranslator::GetUniversalResourceIdentifierFileHandle(TMsvId &amp;,RFile &amp;)const</a></p></div><div class="section section apiDesc section apidesc">
<p class="p">Gets the results from <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-1F482C3B-1B61-366B-9D08-9B5097CFF7A1">FindUniversalResourceIdentifierFileHandleL()</a> or <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-26015874-7A3A-3AC4-ACD4-A37785EF8463">FindFirstHTMLPageFileHandleL()</a> method calls when they have completed.</p>
<p class="p">Used when retrieving specific parts of an MHTML message, such as inline images that are referenced as MHTML anchors within the HTML part of a message. Refer to RFC 2557 - "MIME Encapsulation of Aggregate Documents, such as HTML (MHTML)" for information about MHTML email messages.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">
<a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-1F482C3B-1B61-366B-9D08-9B5097CFF7A1">FindUniversalResourceIdentifierFileHandleL()</a> or <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-26015874-7A3A-3AC4-ACD4-A37785EF8463">FindFirstHTMLPageFileHandleL()</a> must have been called prior and completed successfully.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aLinkedEntryId</td><td>Returns the message Id of the message entry that contains the resolved body part, providing one is found. Note that you should keep a record of the returned message Id as it is required for resolving any URI's that may be found in the resolved body part. </td></tr><tr class="bg"><td class="parameter">aFile</td><td>Returns the file handle of the file containing the HTML,image, or other such content stored in the message store if the URI has been resolved. If not then this argument is not valid. Ownership is transferred. The caller must close the file handle. </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>If the URI is resolved, returns KErrNone. The output argument aFile is the file handle to the content. If no file is located the KErrNotFound is returned and aFile is not valid. </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-26131DCE-D86E-38B4-A02B-6E605060287C"><a name="GUID-26131DCE-D86E-38B4-A02B-6E605060287C"><!-- --></a>
<a name="GUID-95DC9753-BA64-364E-9B30-AC44D0B9C896"><!-- --></a><h3 class="sectiontitle">GetUniversalResourceIdentifierL ( TMsvId &amp;, TBool &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-3D3D9CD7-C8FD-3F81-9CC5-1A71D4F9751E.html">HBufC</a> *</td><td>GetUniversalResourceIdentifierL</td><td>(</td><td>TMsvId &amp;</td><td><span class="parameter">aLinkedEntryId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a> &amp;</td><td><span class="parameter">aFileFound</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">const [virtual]</td></tr></table></div><div><p>Reimplemented from <a class="xref xref apiRelation apiRelation cxxFunctionReimplemented" href="GUID-8D20A302-652A-307F-AEC1-6696032FA33C.html">MImURITranslator::GetUniversalResourceIdentifierL(TMsvId &amp;,TBool &amp;)const</a></p></div><div class="section section apiDesc section apidesc">
<p class="p">Gets the results from <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-E0EC7F3C-A630-39BF-BDE3-149C5667176C">FindUniversalResourceIdentifierL()</a> or <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-F244243F-935C-32EA-9099-40E06FE68C1E">FindFirstHTMLPageL()</a> method calls when they have completed.</p>
<p class="p">Used when retrieving specific parts of an MHTML message, such as inline images that are referenced as MHTML anchors within the HTML part of a message. Refer to RFC 2557 - "MIME Encapsulation of Aggregate Documents, such as HTML (MHTML)" for information about MHTML email messages.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">
<a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-E0EC7F3C-A630-39BF-BDE3-149C5667176C">FindUniversalResourceIdentifierL()</a> or <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-F244243F-935C-32EA-9099-40E06FE68C1E">FindFirstHTMLPageL()</a> must have been called prior and completed successfully.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aLinkedEntryId</td><td>Returns the message Id of the message entry that contains the resolved body part, providing one is found. Note that you should keep a record of the returned message Id as it is required for resolving any URI's that may be found in the resolved body part. </td></tr><tr class="bg"><td class="parameter">aFileFound</td><td>Returns ETrue if the URI has been resolved and the message entry containing the MHTML part has been located. Returns EFalse otherwise. </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>If the URI is resolved, returns the full path specification and file name of the file containing the HTML, image, or other such content stored in the message store. If no file can be located, the absolute URI is returned instead. </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-3095284C-D445-30E7-BDC3-BA4737D92572"><a name="GUID-3095284C-D445-30E7-BDC3-BA4737D92572"><!-- --></a>
<a name="GUID-952F7B5F-81B5-3E45-BCF6-4B836410FA43"><!-- --></a><h3 class="sectiontitle">NewL ( CMsvEntry &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">CImEmailMessage</a> *</td><td>NewL</td><td>(</td><td>CMsvEntry &amp;</td><td><span class="parameter">aEntry</span></td><td>)</td><td>[static]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Allocates and creates a new <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a> object.</p>
<p class="p">
</p><p class="p">See also: CMsvEntry </p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aEntry</td><td>A CMsvEntry object that relates to a message server entry. This object is used by CImEmailMessage to perform operations on particular message server entries. It does not matter what context aEntry happens to be focused on. </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>A CImEmailMessage message object.</dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-F438E199-E458-3B49-B274-32FDB0703A6A"><a name="GUID-F438E199-E458-3B49-B274-32FDB0703A6A"><!-- --></a>
<a name="GUID-0127EE2B-E567-347D-8A36-C849A9FD595E"><!-- --></a><h3 class="sectiontitle">NewLC ( CMsvEntry &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">CImEmailMessage</a> *</td><td>NewLC</td><td>(</td><td>CMsvEntry &amp;</td><td><span class="parameter">aEntry</span></td><td>)</td><td>[static]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Allocates and creates a new <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-323E701E-EA22-3CC8-AE84-C16880608D44">CImEmailMessage</a> object, leaving the object on the cleanup stack.</p>
<p class="p">
</p><p class="p">See also: CMsvEntry </p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aEntry</td><td>A CMsvEntry object that relates to a message server entry. This object is used by CImEmailMessage to perform operations on particular message server entries. It does not matter what context aEntry happens to be focused on. </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>A CImEmailMessage object.</dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-928A6A91-BC31-3B41-B302-22F17CE924F7"><a name="GUID-928A6A91-BC31-3B41-B302-22F17CE924F7"><!-- --></a>
<a name="GUID-E20991B9-52D4-3952-A748-41A65E321952"><!-- --></a><h3 class="sectiontitle">OpenPlainBodyTextForReadL ( TImEmailEntryType, TInt )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.html">CImPlainBodyText</a> *</td><td>OpenPlainBodyTextForReadL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html">TImEmailEntryType</a></td><td><span class="parameter">aEntryType</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aChunkLength</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">This returns a object of CImPlainBodyText.This needs to be called when bodytext needs to be restored in chunks for Read operation. </p>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aEntryType</td><td>The TImEmailEntryType for this message.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>CMsvPlainBodyText </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-B99E759E-E0D6-3A10-B81C-5BFCAF631B7D"><a name="GUID-B99E759E-E0D6-3A10-B81C-5BFCAF631B7D"><!-- --></a>
<h3 class="sectiontitle">OpenPlainBodyTextForWriteL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C <a class="xref xref apiRelation" href="GUID-14EA98A8-06E7-33FF-B2B1-4BC3D044518D.html">CImPlainBodyText</a> *</td><td>OpenPlainBodyTextForWriteL</td><td>(</td><td>)</td><td></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">This returns a object of CImPlainBodyText.This needs to be called when bodytext needs to be created in chunks. </p>
</div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>CImPlainBodyText </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-B3290295-7EEE-3B8B-8F14-166A118ABCDC"><a name="GUID-B3290295-7EEE-3B8B-8F14-166A118ABCDC"><!-- --></a>
<h3 class="sectiontitle">ProgressL (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C const <a class="xref xref apiRelation" href="GUID-FB97E0A3-352A-316F-97C6-69E4741A8120.html">TDesC8</a> &amp;</td><td>ProgressL</td><td>(</td><td>)</td><td>const </td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns a message entry Id as a type-safe package buffer (TPckg&lt;TMsvId&gt;). The meaning of the Id depends on the request as follows:</p>
<p class="p">
<a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-755263D8-C404-3D87-928D-3AA8CA9D473D">AddAttachmentL()</a>, AddMessageAsAttachmentL(), and <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-6A135956-34B7-3B9A-93CC-4D72958B19C9">AddRelatedPartL()</a>: While the attachment, message, or related part is being added, a null Id (KMsvNullIndexEntryId); Once the attachment, message, or related part has been added, the entry Id of the newly created attachment, message, or related part.</p>
<p class="p">DeleteAttachmentL() and DeleteAttachedMessageL(): While the attachment or attached message is being removed, a null Id (KMsvNullIndexEntryId); Once the attachment or attached message has been removed, the Id of the message from which the attachment or attached message was removed.</p>
<p class="p">
<a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-7E9C1C97-9CEB-353D-AF02-AF97D4BB9100">StoreBodyTextL()</a>: While the body text is being stored, a null Id (KMsvNullIndexEntryId); Once the text has been stored, the Id of the message for which the body text was stored.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">Call this method after the following asynchronous calls have completed to check progress. <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-755263D8-C404-3D87-928D-3AA8CA9D473D">AddAttachmentL()</a> AddMessageAsAttachmentL() <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-6A135956-34B7-3B9A-93CC-4D72958B19C9">AddRelatedPartL()</a> DeleteAttachmentL() DeleteAttachedMessageL() <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-7E9C1C97-9CEB-353D-AF02-AF97D4BB9100">StoreBodyTextL()</a></dd>
</dl>
<pre class="pre codeblock">// Example code demonstrating how to retrieve the progress.

// Create and initialise a temporary TPckg object that can hold a message Id.
TMsvId msgId;
TPckg&lt;TMsvId&gt; param(msgId);

// Copy the message Id returned from the ProgressL() call into the
// temporary TPckg object.
param.Copy(emailMsg-&gt;ProgressL());  // where emailMsg is of type CImEmailMessage.

// Check the value of the returned message Id in the TPckg object.
if (msgId != KMsvNullIndexEntryId)
	{
	// More code...
	} </pre>
</div>
<p class="p">
</p></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>The entry Id as a type-safe packaged buffer (TPckg&lt;TMsvId&gt;). </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-E200C456-EFF3-3EA2-BCD3-D2B887A7AAE0"><a name="GUID-E200C456-EFF3-3EA2-BCD3-D2B887A7AAE0"><!-- --></a>
<a name="GUID-B0E320DA-B428-33D3-96D2-8AC1AC33A754"><!-- --></a><h3 class="sectiontitle">RemoveAttachedMessageL ( TMsvAttachmentId, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>RemoveAttachedMessageL</td><td>(</td><td>TMsvAttachmentId</td><td><span class="parameter">aAttachmentId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-F262A7E1-D1AA-3497-ABCC-198907C8E089"><a name="GUID-F262A7E1-D1AA-3497-ABCC-198907C8E089"><!-- --></a>
<a name="GUID-8A902BDB-5E4D-3DAA-BCAD-A7344EC9CA65"><!-- --></a><h3 class="sectiontitle">RemoveAttachmentL ( TMsvAttachmentId, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>RemoveAttachmentL</td><td>(</td><td>TMsvAttachmentId</td><td><span class="parameter">aAttachmentId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-5703C3D1-349D-3F12-BF3E-0313D6729649"><a name="GUID-5703C3D1-349D-3F12-BF3E-0313D6729649"><!-- --></a>
<h3 class="sectiontitle">Selection (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C const <a class="xref xref apiRelation" href="GUID-6BC8851B-D913-3CE5-B343-5163661E8AD5.html">CMsvEntrySelection</a> &amp;</td><td>Selection</td><td>(</td><td>)</td><td>const </td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns a selection of entries. The entries are either the results of <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-5C4E5662-6B29-3929-AFDA-C25956FDFD79">GetMessageDigestEntriesL()</a>, or of <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-CC3CD148-7F6E-3E2E-88B2-4730E95F38B2">GetBodyTextL()</a>.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">
<a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-5C4E5662-6B29-3929-AFDA-C25956FDFD79">GetMessageDigestEntriesL()</a> or <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-CC3CD148-7F6E-3E2E-88B2-4730E95F38B2">GetBodyTextL()</a> must be called prior and successfully completed.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>Selection of entries populated by GetMessageDigestEntriesL() or GetBodyTextL(). </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-41FBEBD1-34C3-33A6-A0BE-A122B4ED23AE"><a name="GUID-41FBEBD1-34C3-33A6-A0BE-A122B4ED23AE"><!-- --></a>
<a name="GUID-F03A7811-5C59-3BE3-8704-8EAA4429B3C2"><!-- --></a><h3 class="sectiontitle">SetCharacterSetL ( TMsvId, TUint )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>SetCharacterSetL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TUint</a></td><td><span class="parameter">aCharacterSetId</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Stores the new character set that the message will be displayed as next time it is viewed.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">The store_8bit_body_text flag in imcm.rss should be enabled. This is done at build time by the manufacturer.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that the character set will be returned from. The entry must be of type KUidMsvMessageEntry. </td></tr><tr class="bg"><td class="parameter">aCharacterSetId</td><td>The character set Id to be stored in the message store. Setting this value to zero will cause the message to be displayed in its original character set when it was viewed for the first time after it was downloaded. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry can not be located in the message store, or the character set information can not be located. If the character set information cannot be located, it could be because it was not stored when downloaded. To enable this functionality set the store_8bit_body_text flag in imcm.rss. It is also possible that a call to</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-7E9C1C97-9CEB-353D-AF02-AF97D4BB9100"><a name="GUID-7E9C1C97-9CEB-353D-AF02-AF97D4BB9100"><!-- --></a>
<a name="GUID-791117B4-C946-3D43-AE1E-68DDC10F85A3"><!-- --></a><h3 class="sectiontitle">StoreBodyTextL ( TMsvId, CRichText &amp;, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>StoreBodyTextL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td>CRichText &amp;</td><td><span class="parameter">aRichText</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously stores a body text part for the specified message. After the call has completed, calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-B3290295-7EEE-3B8B-8F14-166A118ABCDC">ProgressL()</a> will return the Id of the message entry for which the body text was stored.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">This function should only be used on messages created using <a class="xref" href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498">CImEmailOperation</a>.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that the body text will be stored in. The entry must be of type KUidMsvMessageEntry. </td></tr><tr class="bg"><td class="parameter">aRichText</td><td>A rich text object (CRichText) that contains the message body text. </td></tr><tr><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-8418C768-63DE-3547-B4F1-6BB65D05C322"><a name="GUID-8418C768-63DE-3547-B4F1-6BB65D05C322"><!-- --></a>
<h3 class="sectiontitle">StoreBodyTextL ( TMsvId, CRichText &amp;, TRequestStatus &amp;, TBool )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>StoreBodyTextL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td>CRichText &amp;</td><td><span class="parameter">aRichText</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TBool</a></td><td><span class="parameter">aUsePlainTextStorage</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously stores a body text part for the specified message. After the call has completed, calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-B3290295-7EEE-3B8B-8F14-166A118ABCDC">ProgressL()</a> will return the Id of the message entry for which the body text was stored.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">This function should only be used on messages created using <a class="xref" href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498">CImEmailOperation</a>.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that the body text will be stored in. The entry must be of type KUidMsvMessageEntry. </td></tr><tr class="bg"><td class="parameter">aRichText</td><td>A rich text object (CRichText) that contains the message body text. </td></tr><tr><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr><tr class="bg"><td class="parameter">aUsePlainTextStorage</td><td>if set to ETrue inidcates that the new message entry needs to be created as plain text if set to EFalse indicates that message will be created as richtext entry. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-064DBAA5-6CF2-3E44-9601-41514133D761"><a name="GUID-064DBAA5-6CF2-3E44-9601-41514133D761"><!-- --></a>
<a name="GUID-7007B9BF-6134-3D3A-911D-ECC0029EC34D"><!-- --></a><h3 class="sectiontitle">StoreBodyTextWithMimeHeaderL ( TMsvId, CRichText &amp;, const CImMimeHeader &amp;, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>IMPORT_C void</td><td>StoreBodyTextWithMimeHeaderL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aMessageId</span>,</td></tr><tr><td colspan="3"> </td><td>CRichText &amp;</td><td><span class="parameter">aRichText</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-79DEFCEC-D000-38F2-9FE5-C6729AC92C1D.html">CImMimeHeader</a> &amp;</td><td><span class="parameter">aMimeHeader</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2"></td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Asynchronously stores a body text part for the specified message. A Mime header is created with the passed in the <a class="xref" href="GUID-79DEFCEC-D000-38F2-9FE5-C6729AC92C1D.html#GUID-79DEFCEC-D000-38F2-9FE5-C6729AC92C1D">CImMimeHeader</a> object passed. After the call has completed, calling <a class="xref" href="GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html#GUID-B3290295-7EEE-3B8B-8F14-166A118ABCDC">ProgressL()</a> will return the Id of the message entry for which the body text was stored.</p>
<div class="p">
<dl class="dl precondition">
<dt class="dt dlterm">Pre-condition</dt>
<dd class="dd">This function should only be used on messages created using <a class="xref" href="GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498.html#GUID-3F7DC1AB-D13C-31E9-967B-526AD72CD498">CImEmailOperation</a>.</dd>
</dl>
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aMessageId</td><td>The entry Id of the email message that the body text will be stored in. The entry must be of type KUidMsvMessageEntry. </td></tr><tr class="bg"><td class="parameter">aRichText</td><td>A rich text object (CRichText) that contains the message body text. </td></tr><tr><td class="parameter">aMimeHeader</td><td>A MIME header object (CImMimeHeader) that contains the content-type etc. </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>Asynchronous status object (TRequestStatus) that is signalled when the operation completes. aStatus should be checked by the caller to ensure that the operation was successful. </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">aMessageId entry could not be located.</td></tr></table></div><div class="section panic"><table class="panic"><tr><th class="panic">Panic Codes</th></tr><tr><td class="paniccode">imcm</td><td class="panicvalue">10 aMessageId is not of type KUidMsvMessageEntry.</td></tr></table></div></div>
</div>
</div></div><div class="footer"><hr /><div class="copy"> Nokia 2005.</div></div>
</div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-323E701E-EA22-3CC8-AE84-C16880608D44.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:14:09 GMT -->
</html>