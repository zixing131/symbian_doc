<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html lang="en-us" xml:lang="en-us">

<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:14:44 GMT -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="copyright" content="(C) Copyright 2005" />
<meta name="DC.rights.owner" content="(C) Copyright 2005" />
<meta name="DC.Type" content="cxxClass" />
<meta name="DC.Title" content="MMsvAttachmentManager" />
<meta name="abstract" content="" />
<meta name="description" content="" />
<meta name="DC.Format" content="XHTML" />
<meta name="DC.Identifier" content="GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD" />
<title>MMsvAttachmentManager</title>
<meta name="keywords" content="api" /><link rel="stylesheet" type="text/css" href="css/nokiacxxref.css" />
<link href="css/s60/style.css" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_cpp3.html" rel="stylesheet" type="text/css" />
<link href="PLUGINS_ROOT/com.nokia.forum.library/css/category-cover_cpp3.html" rel="stylesheet" type="text/css" /></head>
<body id="GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD"><a name="GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD"><!-- --></a><div class="body"><div class="contentLeft prTxt">
<h1 class="sectiontitle">MMsvAttachmentManager Class Reference</h1>
<div class="state state apiQualifier apiQualifier cxxClassDeclarationFile section include"><p>#include 
            
                    &lt;mw/mmsvattachmentmanager.h&gt;
                </p></div>
<div class="section signature"><table class="signature"><tr><td>class MMsvAttachmentManager</td></tr></table></div><div class="section member-index"><table class="member-index"><thead><tr><th colspan="2">Public Member Functions</th></tr></thead><tbody><tr><td align="right" class="code">pure virtual void</td><td><a href="#GUID-2903F0E9-B787-3A97-8225-831948A8D2C3">AddAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">pure virtual void</td><td><a href="#GUID-A8B33797-C1D8-352F-803E-255C0F66E952">AddAttachmentL</a>(RFile &amp;, <a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">pure virtual void</td><td><a href="#GUID-95FCA2F7-13A9-32F8-A211-C32242C5A8F8">AddEntryAsAttachmentL</a>(TMsvId, <a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">pure virtual void</td><td><a href="#GUID-7010CF3A-AFEE-3167-B8D5-81427C27E9EF">AddLinkedAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">pure virtual 
					<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
</td><td><a href="#GUID-86FFB1FF-5058-3A9A-9E54-456302E35156">AttachmentCount</a>()</td></tr><tr class="bg"><td align="right" class="code">pure virtual void</td><td><a href="#GUID-1E001118-03CD-3497-94BD-483E839E898E">CancelRequest</a>()</td></tr><tr><td align="right" class="code">pure virtual void</td><td><a href="#GUID-6EBDE9DF-22CD-387F-8505-DA5031299CB3">CreateAttachmentL</a>(const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, RFile &amp;, <a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">pure virtual 
					RFile
</td><td><a href="#GUID-3524A520-5092-3502-8A2D-22528F181C5F">GetAttachmentFileForWriteL</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr><td align="right" class="code">pure virtual 
					RFile
</td><td><a href="#GUID-CDB6355E-78F7-3B9D-BCF3-A6BEA2AE9914">GetAttachmentFileForWriteL</a>(<a class="xref xref apiRelation" href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a>)</td></tr><tr class="bg"><td align="right" class="code">pure virtual 
					RFile
</td><td><a href="#GUID-41CA832F-928D-3519-B809-2780569CC1C9">GetAttachmentFileL</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr><td align="right" class="code">pure virtual 
					RFile
</td><td><a href="#GUID-EF5E8012-E057-3420-BA74-4C2BB0D878E8">GetAttachmentFileL</a>(<a class="xref xref apiRelation" href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a>)</td></tr><tr class="bg"><td align="right" class="code">pure virtual 
					<a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><a href="#GUID-20112827-F686-38F5-A338-F107F4A7E894">GetAttachmentInfoL</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>)</td></tr><tr><td align="right" class="code">pure virtual 
					<a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><a href="#GUID-DA276F93-DFDB-3A39-A78E-90EEEDC59486">GetAttachmentInfoL</a>(<a class="xref xref apiRelation" href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a>)</td></tr><tr class="bg"><td align="right" class="code">pure virtual void</td><td><a href="#GUID-9D33EC6C-4407-3B5C-9056-E92F08E6C8D7">ModifyAttachmentInfoL</a>(<a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">pure virtual void</td><td><a href="#GUID-04001308-75DE-352E-B773-5EDE21BC8F90">RemoveAttachmentL</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr class="bg"><td align="right" class="code">pure virtual void</td><td><a href="#GUID-12881935-01AB-3166-9623-3719C2F2F441">RemoveAttachmentL</a>(<a class="xref xref apiRelation" href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a>, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr><tr><td align="right" class="code">pure virtual void</td><td><a href="#GUID-38F8ACC5-DB5B-39D3-980F-E1C514330B5D">RenameAttachmentL</a>(<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>, const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;, <a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;)</td></tr></tbody></table></div><div class="section section apiDesc section apidesc"><h2 class="sectiontitle">Detailed Description</h2>
<p class="p">Defines the attachment management interface.</p>
<p class="p">This class is a pure virtual interface class that defines the APIs to be used for attachment management in the Messaging Framework. It is expected that the clients of this interface will be MTMs implementations that require attachment management.</p>
<p class="p">The API allows is based around the use of the <a class="xref" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html#GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F">CMsvAttachment</a> object that represents any type of attachment that is supported by the Messaging Framework. The <a class="xref" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html#GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F">CMsvAttachment</a> object provides users with various attributes about the attachment without having to actually load or retrieve the attachment.</p>
<p class="p">This attachment manager API supports the following different types of attachments: 1 - File attachments, file based attachments that are copied or created in the message store. 2 - Linked file attachments, file based attachments that are not copied and are simply linked to the file location on disk. 3 - Message entry attachments, existing message entries that can be registered as attachments of another message entry.</p>
<p class="p">For file based attachments, this API also supports the retrieval of the files as open read-only file handles.</p>
<p class="p">All functionality that requires the attachment manager to be in edit mode have been defined as asynchronous. The attachment manager does not allow multiple asynchronous requests to be made at the same time.</p>
<p class="p">
</p><p class="p">See also: <a class="xref" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html#GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F">CMsvAttachment</a> </p>
</div>
<h2 class="sectiontitle">Member Function Documentation</h2><div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-2903F0E9-B787-3A97-8225-831948A8D2C3"><a name="GUID-2903F0E9-B787-3A97-8225-831948A8D2C3"><!-- --></a>
<a name="GUID-283B631D-0166-30F9-BBA3-CA364DB66B45"><!-- --></a><h3 class="sectiontitle">AddAttachmentL ( const TDesC &amp;, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFilePath</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Adds an attachment to the message store by file path.</p>
<p class="p">The attachment file must be located in a public area. The file path must also be a full path specification. The file is copied into the message store.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFilePath</td><td>The absolute file path of the attachment file.  </td></tr><tr class="bg"><td class="parameter">aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr><td class="parameter">aStatus</td><td>The client's request status to complete when the operation has completed.  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-A8B33797-C1D8-352F-803E-255C0F66E952"><a name="GUID-A8B33797-C1D8-352F-803E-255C0F66E952"><!-- --></a>
<h3 class="sectiontitle">AddAttachmentL ( RFile &amp;, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddAttachmentL</td><td>(</td><td>RFile &amp;</td><td><span class="parameter">aFileHandle</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Adds an attachment to the message store by file handle.</p>
<p class="p">This is used to add an attachment from an open file handle such as when adding a file from the caller's private area. The file is copied into the message store. The message server is responsible for closing the file handle once copied.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFileHandle</td><td>An open file handle for the attachment file. Ownership is transferred. The caller must close the file handle.  </td></tr><tr class="bg"><td class="parameter">aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr><td class="parameter">aStatus</td><td>The client's request status to complete.  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-95FCA2F7-13A9-32F8-A211-C32242C5A8F8"><a name="GUID-95FCA2F7-13A9-32F8-A211-C32242C5A8F8"><!-- --></a>
<a name="GUID-D7201C5D-4109-38EB-918B-BAFEDA99A3D0"><!-- --></a><h3 class="sectiontitle">AddEntryAsAttachmentL ( TMsvId, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddEntryAsAttachmentL</td><td>(</td><td>TMsvId</td><td><span class="parameter">aEntryId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Adds a message entry as an attachment.</p>
<p class="p">The message entry is registered as an attachment of the current message entry. The attachment message entry is not copied.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aEntryId</td><td>The message Id of the entry to register as an attachment.  </td></tr><tr class="bg"><td class="parameter">aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr><td class="parameter">aStatus</td><td>The client's request status to complete.  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-7010CF3A-AFEE-3167-B8D5-81427C27E9EF"><a name="GUID-7010CF3A-AFEE-3167-B8D5-81427C27E9EF"><!-- --></a>
<a name="GUID-D11BB466-2529-3C49-AFAB-810806376478"><!-- --></a><h3 class="sectiontitle">AddLinkedAttachmentL ( const TDesC &amp;, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>AddLinkedAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFilePath</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Adds an attachment as a linked file attachment.</p>
<p class="p">The attachment is added as a link by its file path. The attachment is not copied to the message store. The attachment is linked and therefore must be in a public location.</p>
<p class="p">It is possible to change a linked attachment file after it has been attached to a message entry. No integrity checking is carried out. This is left to individual MTMs or implementors of this interface to decide if any checking is required such as checking if the size has changed.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFilePath</td><td>The absolute file path of the linked attachment file.  </td></tr><tr class="bg"><td class="parameter">aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr><td class="parameter">aStatus</td><td>The client's request status to complete.  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-86FFB1FF-5058-3A9A-9E54-456302E35156"><a name="GUID-86FFB1FF-5058-3A9A-9E54-456302E35156"><!-- --></a>
<h3 class="sectiontitle">AttachmentCount (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a>
</td><td>AttachmentCount</td><td>(</td><td>)</td><td>const [pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Counts the number of attachments.</p>
<p class="p">Returns the number of attachments associated with the message entry. This includes all the attachments that have not been commited yet. </p>
</div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>The number of attachments. </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-1E001118-03CD-3497-94BD-483E839E898E"><a name="GUID-1E001118-03CD-3497-94BD-483E839E898E"><!-- --></a>
<h3 class="sectiontitle">CancelRequest (  )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>CancelRequest</td><td>(</td><td>)</td><td>[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Cancels the last asynchronous operation that was requested.</p>
<p class="p">Allows callers to cancel the last asynchronous operation. This will have no effect if an asynchronous is not waiting to complete. </p>
</div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-6EBDE9DF-22CD-387F-8505-DA5031299CB3"><a name="GUID-6EBDE9DF-22CD-387F-8505-DA5031299CB3"><!-- --></a>
<a name="GUID-DA2E53AD-EC8F-38F9-8D5C-03AC356E7B64"><!-- --></a><h3 class="sectiontitle">CreateAttachmentL ( const TDesC &amp;, RFile &amp;, CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>CreateAttachmentL</td><td>(</td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aFileName</span>,</td></tr><tr><td colspan="3"> </td><td>RFile &amp;</td><td><span class="parameter">aAttachmentFile</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Creates a new empty attachment file.</p>
<p class="p">The caller is returned an open writable file handle to an empty attachment file in the message store. The caller must pass in an uninitialised file handle. The file handle cannot be used until the asynchronous request completes successfully. If the request is sucessful the file handle is open and must close by the caller once the data has been written to it.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aFileName</td><td>The filename to assign to the newly create attachment file.  </td></tr><tr class="bg"><td class="parameter">aAttachmentFile</td><td>An uninitialised file handle. This is opened and can be written to if the request is successful. Ownership is transferred . The caller must close the file handle.  </td></tr><tr><td class="parameter">aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-3524A520-5092-3502-8A2D-22528F181C5F"><a name="GUID-3524A520-5092-3502-8A2D-22528F181C5F"><!-- --></a>
<a name="GUID-E661ADDD-3BAC-381A-8F51-B9CED0621B77"><!-- --></a><h3 class="sectiontitle">GetAttachmentFileForWriteL ( TInt )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
RFile
</td><td>GetAttachmentFileForWriteL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aIndex</span></td><td>)</td><td>[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns an open writable file handle for the attachment file.</p>
<p class="p">Returns a writable open file handle for the attachment file. This only applies to file based attachments ie. file attachment and linked file attachments. The caller is responsible for closing the returned file handle.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aIndex</td><td>The array index position of the attachment.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>A writable open file handle for the attachment file. Caller must close the handle. </dd></dl></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">If the attachment is not a file attachment in the message store.</td></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-CDB6355E-78F7-3B9D-BCF3-A6BEA2AE9914"><a name="GUID-CDB6355E-78F7-3B9D-BCF3-A6BEA2AE9914"><!-- --></a>
<h3 class="sectiontitle">GetAttachmentFileForWriteL ( TMsvAttachmentId )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
RFile
</td><td>GetAttachmentFileForWriteL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a></td><td><span class="parameter">aId</span></td><td>)</td><td>[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns an open writable file handle for the attachment file.</p>
<p class="p">Returns a writable open file handle for the attachment file. This only applies to file based attachments ie. file attachment and linked file attachments. The caller is responsible for closing the returned file handle.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>A writable open file handle for the attachment file. Caller must close the handle. </dd></dl></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">If the attachment is not a file attachment in the message store.</td></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">If an attachment with the specified attachment Id is not found.</td></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-41CA832F-928D-3519-B809-2780569CC1C9"><a name="GUID-41CA832F-928D-3519-B809-2780569CC1C9"><!-- --></a>
<a name="GUID-59A1131A-B9D4-3D19-AF90-21CF1368780A"><!-- --></a><h3 class="sectiontitle">GetAttachmentFileL ( TInt )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
RFile
</td><td>GetAttachmentFileL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aIndex</span></td><td>)</td><td>[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns an open file handle for the attachment file.</p>
<p class="p">Returns a read-only open file handle for the attachment file. This only applies to file based attachments ie. file attachment and linked file attachments. The caller is responsible for closing the returned file handle.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aIndex</td><td>The array index position of the attachment.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>A read-only open file handle for the attachment file. Caller must close the handle. </dd></dl></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">If the attachment is not a file attachment in the message store.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-EF5E8012-E057-3420-BA74-4C2BB0D878E8"><a name="GUID-EF5E8012-E057-3420-BA74-4C2BB0D878E8"><!-- --></a>
<h3 class="sectiontitle">GetAttachmentFileL ( TMsvAttachmentId )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
RFile
</td><td>GetAttachmentFileL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a></td><td><span class="parameter">aId</span></td><td>)</td><td>[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns an open file handle for the attachment file.</p>
<p class="p">Returns a read-only open file handle for the attachment file. This only applies to file based attachments ie. file attachment and linked file attachments. The caller is responsible for closing the returned file handle.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>A read-only open file handle for the attachment file. Caller must close the handle. </dd></dl></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotSupported</td><td class="leavevalue">If the attachment is not a file attachment in the message store.</td></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">If an attachment with the specified attachment Id is not found.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-20112827-F686-38F5-A338-F107F4A7E894"><a name="GUID-20112827-F686-38F5-A338-F107F4A7E894"><!-- --></a>
<a name="GUID-8799636A-10B4-3842-8291-848CC143E5FD"><!-- --></a><h3 class="sectiontitle">GetAttachmentInfoL ( TInt )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>GetAttachmentInfoL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aIndex</span></td><td>)</td><td>[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns an attachment info object.</p>
<p class="p">This object contains attributes and information about the attachment without having actually retrieving the actual attachment. The caller assumes ownership of the returned object.</p>
<p class="p">
</p></div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aIndex</td><td>The array index position of the attachment.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>The attachment info for the attachment. Ownership is passed to caller, </dd></dl></div>
</div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-DA276F93-DFDB-3A39-A78E-90EEEDC59486"><a name="GUID-DA276F93-DFDB-3A39-A78E-90EEEDC59486"><!-- --></a>
<h3 class="sectiontitle">GetAttachmentInfoL ( TMsvAttachmentId )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>
<a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td>GetAttachmentInfoL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a></td><td><span class="parameter">aId</span></td><td>)</td><td>[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Returns an attachment info object.</p>
<p class="p">This object contains attributes and information about the attachment without having actually retrieving the actual attachment. The caller assumes ownership of the returned object.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aId</td><td>The attachment Id of the attachment.  </td></tr></table></div>
<div class="ph ph apiDefNote cxxFunctionReturnDesc section returnsdoc"><dl class="returnsdoc"><dt class="dlterm">Return Value</dt><dd>The attachment info for the attachment. Ownership is passed to caller, </dd></dl></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">If an attachment with the specified attachment Id is not found.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-9D33EC6C-4407-3B5C-9056-E92F08E6C8D7"><a name="GUID-9D33EC6C-4407-3B5C-9056-E92F08E6C8D7"><!-- --></a>
<a name="GUID-DF8A67A9-BE80-3D12-9071-64E22D093555"><!-- --></a><h3 class="sectiontitle">ModifyAttachmentInfoL ( CMsvAttachment *, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>ModifyAttachmentInfoL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-8C2B9B89-D6B7-3622-AF26-658F53BCB70F.html">CMsvAttachment</a> *</td><td><span class="parameter">aAttachmentInfo</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Modifies the attachment info for a particular attachment.</p>
<p class="p">This allows callers to modify an existing attachment info object for a particular attachment. The attachment info object passed in replaces the existing attachment info object and takes ownership for the object passed in. It is expected that callers will use GetAttachmentInfoL to get the object, make some changes and pass it back into this method.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aAttachmentInfo</td><td>The attachment info associated with the file. If the routine does not leave, then ownership will be transferred to the attachment manager. If the routine does leave then ownership will not have been transfered and the caller is responsible for cleanup.  </td></tr><tr class="bg"><td class="parameter">aStatus</td><td>The client's request status to complete.  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">If the attachment that is trying to be modified cannot be found.</td></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-04001308-75DE-352E-B773-5EDE21BC8F90"><a name="GUID-04001308-75DE-352E-B773-5EDE21BC8F90"><!-- --></a>
<a name="GUID-3BD2E3BF-AD83-3BFA-9C8D-D823F4F9D71E"><!-- --></a><h3 class="sectiontitle">RemoveAttachmentL ( TInt, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>RemoveAttachmentL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aIndex</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Removes the attachment from the message entry.</p>
<p class="p">This changes the array index values of all the attachments after the removed one. Attachment files stored in the message store are deleted. Linked files and message entry attachments are not deleted, this is left to the caller to do if required.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-12881935-01AB-3166-9623-3719C2F2F441"><a name="GUID-12881935-01AB-3166-9623-3719C2F2F441"><!-- --></a>
<h3 class="sectiontitle">RemoveAttachmentL ( TMsvAttachmentId, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>RemoveAttachmentL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-BC9ADDA9-733C-33D3-B4D7-CE4C70F680B8.html">TMsvAttachmentId</a></td><td><span class="parameter">aId</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Removes the attachment from the message entry.</p>
<p class="p">This changes the array index values of all the attachments after the removed one. Attachment files stored in the message store are deleted. Linked files and message entry attachments are not deleted, this is left to the caller to do if required.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters">
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr><tr><td class="leavecode">KErrNotFound</td><td class="leavevalue">If an attachment with the specified attachment Id is not found.</td></tr></table></div></div>
</div>
<div class="topic reference apiRef apiOperation cxxFunction nested1" id="GUID-38F8ACC5-DB5B-39D3-980F-E1C514330B5D"><a name="GUID-38F8ACC5-DB5B-39D3-980F-E1C514330B5D"><!-- --></a>
<a name="GUID-0F68D29C-7AEA-3D69-AB1E-019EC954528D"><!-- --></a><h3 class="sectiontitle">RenameAttachmentL ( TInt, const TDesC &amp;, TRequestStatus &amp; )</h3>
<div class="body refbody apiDetail apiOperationDetail cxxFunctionDetail section functiondetail"><div class="section signature"><table class="signature"><tr><td>void</td><td>RenameAttachmentL</td><td>(</td><td><a class="xref xref apiRelation" href="GUID-FC2F2B93-3D18-3BCC-9FD6-6BC6B240B667.html">TInt</a></td><td><span class="parameter">aIndex</span>,</td></tr><tr><td colspan="3"> </td><td>const <a class="xref xref apiRelation" href="GUID-440FF2B4-353B-3097-A2BA-5887D10B8B23.html">TDesC</a> &amp;</td><td><span class="parameter">aNewName</span>,</td></tr><tr><td colspan="3"> </td><td><a class="xref xref apiRelation" href="GUID-E0B34F3E-D4C4-3232-B8B1-7DB35B454646.html">TRequestStatus</a> &amp;</td><td><span class="parameter">aStatus</span></td></tr><tr><td colspan="2"> </td><td>)</td><td colspan="2">[pure virtual]</td></tr></table></div><div class="section section apiDesc section apidesc">
<p class="p">Renames the physical filename of an attachment.</p>
<div class="p">
</div>
</div>
<div class="ph ph apiDefItem apiDefItem cxxFunctionParameters section parameters"><table class="parameters"><tr><th>Parameters</th></tr><tr><td class="parameter">aIndex</td><td>The array index position of the attachment to be renamed.  </td></tr><tr class="bg"><td class="parameter">aNewName</td><td>The new name of the attachment.  </td></tr><tr><td class="parameter">aStatus</td><td>The client's request status to complete.  </td></tr></table></div>
<div class="section leave"><table class="leave"><tr><th class="leave">Leave Codes</th></tr><tr><td class="leavecode">KErrAccessDenied</td><td class="leavevalue">If attachment manager is in read-only mode.</td></tr><tr><td class="leavecode">KErrAlreadyExists</td><td class="leavevalue">If the supplied attachment filename already exists.</td></tr></table></div></div>
</div>
</div></div><div class="footer"><hr /><div class="copy">Â© Nokia 2005.</div></div>
</div></div></div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/belle/GUID-C6E5F800-0637-419E-8FE5-1EBB40E725AA/GUID-4E2B0CEA-1EDA-3452-895D-3CE1B59FD8FD.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 04:14:44 GMT -->
</html>