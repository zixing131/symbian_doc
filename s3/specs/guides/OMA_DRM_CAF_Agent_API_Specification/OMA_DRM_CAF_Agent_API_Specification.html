<?xml version='1.0' encoding='utf-8'?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
 <!-- Generated by Xbuild version: 5.0.22 -->
 
<!-- Mirrored from devlib.symbian.slions.net/s3/specs/guides/OMA_DRM_CAF_Agent_API_Specification/OMA_DRM_CAF_Agent_API_Specification.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:24:49 GMT -->
<head>
  <title>
   OMA DRM CAF Agent API Specification in drm package
  </title>
  <link href="../../../a_stock/css/arch_sdl.css" rel="stylesheet" type="text/css" />
  <?php
	include_once ($_SERVER["DOCUMENT_ROOT"]. '/includes/skin_constants.php');
	include_once (CURRENT_SKIN_PATH.'/sdl_head.html');
	???>
 </head>
 <body id="swad">
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_header.html'); ???>
  <div id="main_content">
   <table width="100%" cellpadding="0" cellspacing="0" border="0">
    <tr>
     <td valign="top" width="100%">
      <div id="main_content_txt">
       <div class="main_content_padding">
        <div id="main">
         <div id="authoredContent">
          <div class="section">
           <a name="OMA_DRM_CAF_Agent_API_Specification">
           </a>
           <h1>
            OMA DRM CAF Agent API
           </h1>
           <p>
            <em>
             Changes in OMA DRM CAF Agent API documentation
            </em>
           </p>
           <table class="TableWrap" border="1" cellpadding="1" cellspacing="0">
            <tr valign="top">
             <th>
              1.0
             </th>
             <th>
              27.03.2007
             </th>
             <th>
              Approved
             </th>
             <th>
             </th>
            </tr>
            <tr valign="top">
             <td class="Cell">
              <p>
              </p>
             </td>
             <td class="Cell">
              <p>
              </p>
             </td>
             <td class="Cell">
              <p>
              </p>
             </td>
             <td class="Cell">
              <p>
              </p>
             </td>
            </tr>
           </table>
           <p>
            <em>
             Changes in OMA DRM CAF Agent API
            </em>
           </p>
           <table class="TableWrap" border="1" cellpadding="1" cellspacing="0">
            <tr valign="top">
             <th>
              1.0
             </th>
             <th>
              First version.
             </th>
            </tr>
            <tr valign="top">
             <td class="Cell">
              <p>
              </p>
             </td>
             <td class="Cell">
              <p>
              </p>
             </td>
            </tr>
           </table>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2eContents">
            </a>
            <h2>
             Contents
            </h2>
            <ul>
             <li>
              <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic1" title="This API specifies the agent-specific attributes and commands for the OMA DRM CAF Agent. It is an extension to Symbian CAF API.">
               Purpose
              </a>
              <ul>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic1%2e1" title="OMA DRM CAF API is available on S60 3rd Edition and later.">
                 Constraints
                </a>
               </li>
              </ul>
             </li>
             <li>
              <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic2" title="OMA DRM CAF Agent API is a collection of enumerations and constants that can be used with CAF. It does not contain any classes or function declarations itself.">
               API description
              </a>
              <ul>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic2%2e1" title="OMA DRM CAF Agent API covers agent specific commands and attributes. These are handled by invoking the following CAF methods: CManager GetAttribute GetAttributeSet GetStringAttribute GetStringAttributeSet AgentSpecificCommand CContent GetAttribute GetAttributeSet GetStringAttribute GetStringAttributeSet AgentSpecificCommand CData GetAttribute GetAttributeSet GetStringAttribute GetStringAttributeSet AgentSpecificCommand">
                 Use cases
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic2%2e2" title="This API does not contain any classes. All the classes required to use OMA DRM CAF Agent are parts of CAF API.">
                 API class structure
                </a>
               </li>
              </ul>
             </li>
             <li>
              <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3" title="The following sections illustrate the most common use cases of OMA DRM CAF Agent API">
               Using OMA DRM CAF Agent API
              </a>
              <ul>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e1" title="// allocate a content object, specify that we only want to peek at it CContent* content = CContent::NewL(fileName, EPeek, EContentShareReadOnly); TInt value = 0; if (content-&gt;GetAttribute(EFileType, value) == KErrNone) { if (value == ENoDcf) { // the file is not an OMA DRM file } else if (value == EOma1Dcf) { // the file is an OMA DRM 1.0 file } else if (value == EOma2Dcf) { // the file is an OMA DRM 2.0 file } } else { // the file type could not be determined }">
                 Determining the file type
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e2" title="// allocate a data object, specify that we only want to peek at it, and // that we want the default part of the file CData* data = CData::NewL(TVirtualPathPtr(fileName, KDefaultContentObject), EPeek, EContentShareReadOnly); TBuf&lt;256&gt; part; if (data-&gt;GetStringAttribute(EInstantPreviewUri, part) == KErrNone &amp;&amp; part.Length() &gt; 0) { delete data; // open the part, now with the actual intent data = CData::NewL(TVirtualPathPtr(fileName, part), EView, EContentShareReadOnly); // do something with the data … } else { // no preview part available }">
                 Accessing embedded preview parts
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e3" title="// allocate a content object, specify that we only want to peek at it, // but we need to be able to write CContent* content = CContent::NewL(fileName, EPeek, EContentShareReadWrite); if (content-&gt;AgentSpecificCommand(EEmbedDomainRo, KNullDesC, KNullDesC) == KErrNone) { // embedding succeeded }">
                 Inserting domain Rights objects
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e4" title="// Import is handling via the CSupplier class CSupplier* supplier = CSupplier::NewLC(); CMetaDataArray* metaData = CMetaDataArray::NewLC(); // Set the target for the encrypted file supplier-&gt;SetOutputDirectoryL(KEncryptedDir); // The agent is selected based on the MIME type of the data to be imported CImportFile* file = supplier-&gt;ImportFileL(KOma1DrmMessageContentType, *metaData, KTempDcfName); file-&gt;WriteData(KDMSimple); file-&gt;WriteDataComplete(); CSupplierOutputFile&amp; output = file-&gt;OutputFileL(0);">
                 Processing DRM messages
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e5" title='CSupplier* supplier = CSupplier::NewLC(); CMetaDataArray* metaData = CMetaDataArray::NewLC(); // Tell the agent which MIME type to use for the encrypted data metaData-&gt;AddL(KOmaImportMimeTypeField, _L8("image/gif")); supplier-&gt;SetOutputDirectoryL(KEncryptedDir); // The KOmaImportContentType is a OMA DRM agent specific MIME type which // indicates that plain content is to be encrypted CImportFile* file = supplier-&gt;ImportFileL(KOmaImportContentType, *metaData, KTempDcfName); file-&gt;WriteData(KDMSimple); file-&gt;WriteDataComplete(); CSupplierOutputFile&amp; output = file-&gt;OutputFileL(0);'>
                 Encryption of content
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e6" title="Error handling is defined in relevant CAF operations. In addition to that, the KErrOverflow error indicates that the given output buffer is not large enough to hold the result of the requested operation.">
                 Error handling
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e7" title="The methods returning string attribute values and the agent specific commands must be called with enough memory allocated in the output parameters. Otherwise, the function calls fail with the KErrOverflow error code.">
                 Memory overhead
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e8" title="CAF API can be extended using agent-specific commands and attributes, and OMA DRM CAF Agent API is such an extension. It is expected that any additional functionality of OMA DRM CAF Agent will be provided by adding new attribute and command enumeration values.">
                 Extensions to the API
                </a>
               </li>
              </ul>
             </li>
             <li>
              <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic4">
               Glossary
              </a>
              <ul>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic4%2e1">
                 Abbreviations
                </a>
               </li>
               <li>
                <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic4%2e2">
                 Definitions
                </a>
               </li>
              </ul>
             </li>
             <li>
              <a href="OMA_DRM_CAF_Agent_API_Specification.html#OMA_DRM_CAF_Agent_API_Specification%2etopic5">
               References
              </a>
             </li>
            </ul>
           </div>
          </div>
          <div class="section">
           <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic1">
           </a>
           <h1>
            Purpose
           </h1>
           <p>
            This API specifies the agent-specific attributes and commands for the OMA
DRM CAF Agent. It is an extension to Symbian CAF API.
           </p>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic1%2e1">
            </a>
            <h2>
             Constraints
            </h2>
            <p>
             OMA DRM CAF API is available on S60 3rd Edition and later.
            </p>
           </div>
          </div>
          <div class="section">
           <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic2">
           </a>
           <h1>
            API description
           </h1>
           <p>
            OMA DRM CAF Agent API is a collection of enumerations and constants that
can be used with CAF. It does not contain any classes or function declarations
itself.
           </p>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic2%2e1">
            </a>
            <h2>
             Use cases
            </h2>
            <p>
             OMA DRM CAF Agent API covers agent specific commands and attributes. These
are handled by invoking the following CAF methods:
             <ul>
              <li>
               <p>
                <code class="ApiItem">
                 CManager
                </code>
                <ul>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetAttribute
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetAttributeSet
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetStringAttribute
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetStringAttributeSet
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    AgentSpecificCommand
                   </code>
                  </p>
                 </li>
                </ul>
               </p>
              </li>
              <li>
               <p>
                <code class="ApiItem">
                 CContent
                </code>
                <ul>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetAttribute
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetAttributeSet
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetStringAttribute
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetStringAttributeSet
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    AgentSpecificCommand
                   </code>
                  </p>
                 </li>
                </ul>
               </p>
              </li>
              <li>
               <p>
                <code class="ApiItem">
                 CData
                </code>
                <ul>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetAttribute
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetAttributeSet
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetStringAttribute
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    GetStringAttributeSet
                   </code>
                  </p>
                 </li>
                 <li>
                  <p>
                   <code class="ApiItem">
                    AgentSpecificCommand
                   </code>
                  </p>
                 </li>
                </ul>
               </p>
              </li>
             </ul>
            </p>
            <p>
             All the functions need to be called on an allocated object of the respective
class.
            </p>
            <div class="RelatedItems">
             Related APIs
            </div>
            <ul>
             <li>
              <code class="ApiItem">
               AgentSpecificCommand
              </code>
             </li>
             <li>
              <code class="ApiItem">
               CContent
              </code>
             </li>
             <li>
              <code class="ApiItem">
               CData
              </code>
             </li>
             <li>
              <code class="ApiItem">
               CManager
              </code>
             </li>
             <li>
              <code class="ApiItem">
               GetAttribute
              </code>
             </li>
             <li>
              <code class="ApiItem">
               GetAttributeSet
              </code>
             </li>
             <li>
              <code class="ApiItem">
               GetStringAttribute
              </code>
             </li>
             <li>
              <code class="ApiItem">
               GetStringAttributeSet
              </code>
             </li>
            </ul>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic2%2e2">
            </a>
            <h2>
             API class structure
            </h2>
            <p>
             This API does not contain any classes. All the classes required to use
OMA DRM CAF Agent are parts of CAF API.
            </p>
           </div>
          </div>
          <div class="section">
           <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3">
           </a>
           <h1>
            Using OMA DRM CAF Agent API
           </h1>
           <p>
            The following sections illustrate the most common use cases of OMA DRM
CAF Agent API
           </p>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e1">
            </a>
            <h2>
             Determining the file type
            </h2>
            <p>
             <pre>
              <code class="cpp">
               //&nbsp;allocate&nbsp;a&nbsp;content&nbsp;object,&nbsp;specify&nbsp;that&nbsp;we&nbsp;only&nbsp;want&nbsp;to&nbsp;peek&nbsp;at&nbsp;it
               <br />
               CContent*&nbsp;content&nbsp;=&nbsp;CContent::NewL(fileName,&nbsp;EPeek,&nbsp;EContentShareReadOnly);
               <br />
               TInt&nbsp;value&nbsp;=&nbsp;0;
               <br />
               <br />
               if&nbsp;(content-&gt;GetAttribute(EFileType,&nbsp;value)&nbsp;==&nbsp;KErrNone)
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;{
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(value&nbsp;==&nbsp;ENoDcf)
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;file&nbsp;is&nbsp;not&nbsp;an&nbsp;OMA&nbsp;DRM&nbsp;file
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(value&nbsp;==&nbsp;EOma1Dcf)
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;file&nbsp;is&nbsp;an&nbsp;OMA&nbsp;DRM&nbsp;1.0&nbsp;file
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;else&nbsp;if&nbsp;(value&nbsp;==&nbsp;EOma2Dcf)
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;file&nbsp;is&nbsp;an&nbsp;OMA&nbsp;DRM&nbsp;2.0&nbsp;file
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;}
               <br />
               else
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;{
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;the&nbsp;file&nbsp;type&nbsp;could&nbsp;not&nbsp;be&nbsp;determined
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;}
              </code>
             </pre>
            </p>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e2">
            </a>
            <h2>
             Accessing embedded preview parts
            </h2>
            <p>
             <pre>
              <code class="cpp">
               //&nbsp;allocate&nbsp;a&nbsp;data&nbsp;object,&nbsp;specify&nbsp;that&nbsp;we&nbsp;only&nbsp;want&nbsp;to&nbsp;peek&nbsp;at&nbsp;it,&nbsp;and
               <br />
               //&nbsp;that&nbsp;we&nbsp;want&nbsp;the&nbsp;default&nbsp;part&nbsp;of&nbsp;the&nbsp;file
               <br />
               CData*&nbsp;data&nbsp;=&nbsp;CData::NewL(TVirtualPathPtr(fileName,&nbsp;KDefaultContentObject),
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EPeek,&nbsp;EContentShareReadOnly);
               <br />
               TBuf&lt;256&gt;&nbsp;part;
               <br />
               <br />
               if&nbsp;(data-&gt;GetStringAttribute(EInstantPreviewUri,&nbsp;part)&nbsp;==&nbsp;KErrNone&nbsp;&amp;&amp;
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;part.Length()&nbsp;&gt;&nbsp;0)
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;{
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;delete&nbsp;data;
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;open&nbsp;the&nbsp;part,&nbsp;now&nbsp;with&nbsp;the&nbsp;actual&nbsp;intent
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;data&nbsp;=&nbsp;CData::NewL(TVirtualPathPtr(fileName,&nbsp;part),&nbsp;EView,
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;EContentShareReadOnly);
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;do&nbsp;something&nbsp;with&nbsp;the&nbsp;data
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;…
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;}
               <br />
               else
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;{
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;no&nbsp;preview&nbsp;part&nbsp;available
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;}
              </code>
             </pre>
            </p>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e3">
            </a>
            <h2>
             Inserting domain Rights objects
            </h2>
            <p>
             <pre>
              <code class="cpp">
               //&nbsp;allocate&nbsp;a&nbsp;content&nbsp;object,&nbsp;specify&nbsp;that&nbsp;we&nbsp;only&nbsp;want&nbsp;to&nbsp;peek&nbsp;at&nbsp;it,
               <br />
               //&nbsp;but&nbsp;we&nbsp;need&nbsp;to&nbsp;be&nbsp;able&nbsp;to&nbsp;write
               <br />
               CContent*&nbsp;content&nbsp;=&nbsp;CContent::NewL(fileName,&nbsp;EPeek,&nbsp;EContentShareReadWrite);
               <br />
               <br />
               if&nbsp;(content-&gt;AgentSpecificCommand(EEmbedDomainRo,&nbsp;KNullDesC,&nbsp;KNullDesC)&nbsp;==
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;KErrNone)
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;{
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;//&nbsp;embedding&nbsp;succeeded
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;}
              </code>
             </pre>
            </p>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e4">
            </a>
            <h2>
             Processing DRM messages
            </h2>
            <p>
             <pre>
              <code class="cpp">
               //&nbsp;Import&nbsp;is&nbsp;handling&nbsp;via&nbsp;the&nbsp;CSupplier&nbsp;class
               <br />
               CSupplier*&nbsp;supplier&nbsp;=&nbsp;CSupplier::NewLC();
               <br />
               CMetaDataArray*&nbsp;metaData&nbsp;=&nbsp;CMetaDataArray::NewLC();
               <br />
               <br />
               //&nbsp;Set&nbsp;the&nbsp;target&nbsp;for&nbsp;the&nbsp;encrypted&nbsp;file
               <br />
               supplier-&gt;SetOutputDirectoryL(KEncryptedDir);
               <br />
               <br />
               //&nbsp;The&nbsp;agent&nbsp;is&nbsp;selected&nbsp;based&nbsp;on&nbsp;the&nbsp;MIME&nbsp;type&nbsp;of&nbsp;the&nbsp;data&nbsp;to&nbsp;be&nbsp;imported
               <br />
               CImportFile*&nbsp;file&nbsp;=&nbsp;supplier-&gt;ImportFileL(KOma1DrmMessageContentType,
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*metaData,&nbsp;KTempDcfName);
               <br />
               file-&gt;WriteData(KDMSimple);
               <br />
               file-&gt;WriteDataComplete();
               <br />
               CSupplierOutputFile&amp;&nbsp;output&nbsp;=&nbsp;file-&gt;OutputFileL(0);
              </code>
             </pre>
            </p>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e5">
            </a>
            <h2>
             Encryption of content
            </h2>
            <p>
             <pre>
              <code class="cpp">
               CSupplier*&nbsp;supplier&nbsp;=&nbsp;CSupplier::NewLC();
               <br />
               CMetaDataArray*&nbsp;metaData&nbsp;=&nbsp;CMetaDataArray::NewLC();
               <br />
               <br />
               //&nbsp;Tell&nbsp;the&nbsp;agent&nbsp;which&nbsp;MIME&nbsp;type&nbsp;to&nbsp;use&nbsp;for&nbsp;the&nbsp;encrypted&nbsp;data
               <br />
               metaData-&gt;AddL(KOmaImportMimeTypeField,&nbsp;_L8(&quot;image/gif&quot;));
               <br />
               supplier-&gt;SetOutputDirectoryL(KEncryptedDir);
               <br />
               <br />
               //&nbsp;The&nbsp;KOmaImportContentType&nbsp;is&nbsp;a&nbsp;OMA&nbsp;DRM&nbsp;agent&nbsp;specific&nbsp;MIME&nbsp;type&nbsp;which
               <br />
               //&nbsp;indicates&nbsp;that&nbsp;plain&nbsp;content&nbsp;is&nbsp;to&nbsp;be&nbsp;encrypted
               <br />
               CImportFile*&nbsp;file&nbsp;=&nbsp;supplier-&gt;ImportFileL(KOmaImportContentType,
               <br />
               &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*metaData,&nbsp;KTempDcfName);
               <br />
               file-&gt;WriteData(KDMSimple);
               <br />
               file-&gt;WriteDataComplete();
               <br />
               CSupplierOutputFile&amp;&nbsp;output&nbsp;=&nbsp;file-&gt;OutputFileL(0);
              </code>
             </pre>
            </p>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e6">
            </a>
            <h2>
             Error handling
            </h2>
            <p>
             Error handling is defined in relevant CAF operations. In addition to that,
the
             <code class="ApiItem">
              KErrOverflow
             </code>
             error indicates that the given output buffer
is not large enough to hold the result of the requested operation.
            </p>
            <div class="RelatedItems">
             Related APIs
            </div>
            <ul>
             <li>
              <code class="ApiItem">
               KErrOverflow
              </code>
             </li>
            </ul>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e7">
            </a>
            <h2>
             Memory overhead
            </h2>
            <p>
             The methods returning string attribute values and the agent specific commands
must be called with enough memory allocated in the output parameters. Otherwise,
the function calls fail with the
             <code class="ApiItem">
              KErrOverflow
             </code>
             error code.
            </p>
            <div class="RelatedItems">
             Related APIs
            </div>
            <ul>
             <li>
              <code class="ApiItem">
               KErrOverflow
              </code>
             </li>
            </ul>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic3%2e8">
            </a>
            <h2>
             Extensions to the API
            </h2>
            <p>
             CAF API can be extended using agent-specific commands and attributes, and
OMA DRM CAF Agent API is such an extension. It is expected that any additional
functionality of OMA DRM CAF Agent will be provided by adding new attribute
and command enumeration values.
            </p>
           </div>
          </div>
          <div class="section">
           <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic4">
           </a>
           <h1>
            Glossary
           </h1>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic4%2e1">
            </a>
            <h2>
             Abbreviations
            </h2>
            <p>
             <em>
             </em>
            </p>
            <table class="TableWrap" border="1" cellpadding="1" cellspacing="0">
             <tr valign="top">
              <th>
               CAF
              </th>
              <th>
               Content Access Framework
              </th>
             </tr>
            </table>
           </div>
           <div class="section">
            <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic4%2e2">
            </a>
            <h2>
             Definitions
            </h2>
            <p>
             <em>
             </em>
            </p>
            <table class="TableWrap" border="1" cellpadding="1" cellspacing="0">
             <tr valign="top">
              <th>
              </th>
              <th>
              </th>
             </tr>
             <tr valign="top">
              <td class="Cell">
               <p>
               </p>
               <p>
                OMA DRM CAF Agent
               </p>
              </td>
              <td class="Cell">
               <p>
               </p>
               <p>
                A DRM Agent, which implements the OMA DRM standard.
               </p>
              </td>
             </tr>
            </table>
           </div>
          </div>
          <div class="section">
           <a name="OMA_DRM_CAF_Agent_API_Specification%2etopic5">
           </a>
           <h1>
            References
           </h1>
           <p>
            <em>
            </em>
           </p>
           <table class="TableWrap" border="1" cellpadding="1" cellspacing="0">
            <tr valign="top">
             <th>
             </th>
             <th>
             </th>
            </tr>
           </table>
          </div>
         </div>
        </div>
       </div>
      </div>
     </td>
    </tr>
   </table>
   <div style="clear: both">
   </div>
  </div>
  <div id="includedFooter">
   <div id="devnet_footer">
    Copyright &copy;2010&nbsp; Nokia Corporation and/or its subsidiary(-ies). All rights reserved.
    <a href="http://www.eclipse.org/legal/epl-v10.html">
    </a>
   </div>
  </div>
  <?php include_once (CURRENT_SKIN_PATH.'/sdl_footer.html'); ???>
 </body>

<!-- Mirrored from devlib.symbian.slions.net/s3/specs/guides/OMA_DRM_CAF_Agent_API_Specification/OMA_DRM_CAF_Agent_API_Specification.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:24:49 GMT -->
</html>
