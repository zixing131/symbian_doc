
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-7B173E02-9697-51F4-A7E8-795AEF547109.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:07:59 GMT -->
<head><meta http-equiv="Content-Type" content="text/html; charset=utf-8" /><meta name="copyright" content="(C) Copyright 2011" /><meta name="DC.rights.owner" content="(C) Copyright 2011" /><meta name="DC.Type" content="concept" /><meta name="DC.Title" content="Thread Priority Scheme" /><meta name="abstract" content="Explains the factors involved in allocating thread priority." /><meta name="description" content="Explains the factors involved in allocating thread priority." /><meta name="DC.Relation" scheme="URI" content="GUID-32E29020-1956-461A-B79A-1492E06049E7" /><meta name="DC.Relation" scheme="URI" content="GUID-E3D2A6ED-8192-563D-8966-DD96B3AF1783" /><meta name="DC.Relation" scheme="URI" content="GUID-0DF9E318-BE97-531E-AB39-A7B5E8787C87" /><meta name="DC.Relation" scheme="URI" content="GUID-A63025D1-7FD4-5120-8A1F-537D6B70103D" /><meta name="DC.Relation" scheme="URI" content="GUID-BBBFC0AF-2E35-5F5C-A3A5-57C4196A6CDA" /><meta name="DC.Relation" scheme="URI" content="GUID-91EBB6E0-932D-506D-B041-7FB8A531EFDD" /><meta name="DC.Format" content="XHTML" /><meta name="DC.Identifier" content="GUID-7B173E02-9697-51F4-A7E8-795AEF547109" /><meta name="DC.Language" content="en" /><title>Thread Priority Scheme </title><link href="css/s60/style.css" rel="stylesheet" type="text/css" /><link href="PLUGINS_ROOT/com.nokia.forum.library/css/category_design.html" rel="stylesheet" type="text/css" /></head><body><div class="body"><div class="contentLeft prTxt"><h1 class="pageHeading" id="GUID-7B173E02-9697-51F4-A7E8-795AEF547109">Thread Priority Scheme</h1><div><p>Explains the factors involved in allocating thread priority.</p>
<p>At any given time, the thread running on Symbian platform is the
one with the highest priority that is ready to run. The priority of
a thread is simply a number; the value determines the priority; the
greater the number, the higher the priority. We call this the <em>true</em> or <em>absolute</em> priority of the thread. </p>
<p>The Kernel schedules a fixed amount of time called a <em>quantum</em> for a thread to run on the CPU, and the scheduler chooses the highest
priority thread that is ready to run. Threads of equal priority are
executed on a <em>round robin basis</em>. </p>
<p>The <em>true</em> priority values range from 0 (lowest) to 63 (highest). </p>
<p>The priority range divides into four broad categories: </p>
<div class="tablenoborder"><a name="GUID-1EAC04DE-B68F-5F95-887C-39E9926F2500"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-1EAC04DE-B68F-5F95-887C-39E9926F2500" frame="border" border="1" rules="all">
<tbody>
<tr class="">
<td class="cellrowborder" valign="top"><p>0</p> </td>
<td class="cellrowborder" valign="top"><p>This is reserved for the <em>null thread</em>, which puts
the processor into idle mode to save power when no other threads are
ready to run. </p> </td>
</tr>
<tr class="bg ">
<td class="cellrowborder" valign="top"><p>1 - 23 </p> </td>
<td class="cellrowborder" valign="top"><p>Used by kernel side threads and user-side applications and
servers </p> </td>
</tr>
<tr class="">
<td class="cellrowborder" valign="top"><p>24 -31 </p> </td>
<td class="cellrowborder" valign="top"><p>Used by kernel side threads and protected system servers,
i.e. servers with the <code class="codeph">ProtServ</code> capability. </p> </td>
</tr>
<tr class="bg ">
<td class="cellrowborder" valign="top"><p>32 - 63 </p> </td>
<td class="cellrowborder" valign="top"><p>Reserved for real-time threads running on the kernel side. </p> </td>
</tr>
</tbody>
</table></div>
<div class="figure" id="GUID-5FFD4994-B20D-5095-8F6E-FB1151A4FF79"><img src="GUID-A95FEDD4-106A-5E14-8B64-3E2882C76666_d0e318450_href.png" /></div>
<ul>
<li id="GUID-2BCF03FE-C23E-5CCA-87CF-4AE9A91FD0D8"><a name="GUID-2BCF03FE-C23E-5CCA-87CF-4AE9A91FD0D8"><!-- --></a><p> <a href="#GUID-0194B574-806B-5BA3-B65C-6DC5A80CAB86">Priority scheme for general user-side threads</a> </p> </li>
<li id="GUID-000499D5-EE19-5838-90CD-8C13AC468A52"><a name="GUID-000499D5-EE19-5838-90CD-8C13AC468A52"><!-- --></a><p> <a href="#GUID-23801A52-4E62-56F4-8D81-E0A417517FDA">Priority scheme for real-time user-side threads</a> </p> </li>
<li id="GUID-1BA97FE4-F817-50E4-A6DA-6B0B64819811"><a name="GUID-1BA97FE4-F817-50E4-A6DA-6B0B64819811"><!-- --></a><p> <a href="#GUID-F5B98A28-EEDA-58BD-A6CC-62C1621D44DF">Thread priority value mapping table</a> </p> </li>
<li id="GUID-2BB44CDE-B566-52C0-869C-C60FB8D6AD94"><a name="GUID-2BB44CDE-B566-52C0-869C-C60FB8D6AD94"><!-- --></a><p> <a href="#GUID-E9AFB6A3-ED3E-5110-82C8-E5E15E0AF899">Platform security notes</a> </p> </li>
</ul>
<div id="GUID-0194B574-806B-5BA3-B65C-6DC5A80CAB86"><h3 class="section-title">Priority
scheme for general user-side threads</h3> <p>User-side threads
do not allocate <em>true</em> priority values directly. Instead, they
allocate priorities using symbolic values defined by enums. Symbian
platform maps these values to the <em>true</em> value. </p> <p>There
are two priority allocation schemes: </p> <ul>
<li id="GUID-6BE65AEC-DC54-5350-8704-538B5E425352"><a name="GUID-6BE65AEC-DC54-5350-8704-538B5E425352"><!-- --></a><p> <a href="#GUID-B9022468-F4E7-536B-B1D4-58DAA9EA5914">Process-relative scheme</a> </p> </li>
<li id="GUID-BBB502EA-950C-5F8C-8CA2-F5F339000A10"><a name="GUID-BBB502EA-950C-5F8C-8CA2-F5F339000A10"><!-- --></a><p> <a href="#GUID-7A38EE63-E955-5432-84E1-F35CB45C931E">Process-independent scheme for general user threads</a> </p> </li>
</ul> <p id="GUID-B9022468-F4E7-536B-B1D4-58DAA9EA5914"><a name="GUID-B9022468-F4E7-536B-B1D4-58DAA9EA5914"><!-- --></a><strong>Process-relative
scheme</strong> </p> <p>This scheme bases the <em>true</em> priority of a
thread on the priority of its owning process and the priority of the
thread relative to the process. This means that changing the process
priority results in a change to the <em>true</em> priority of the thread. </p> <p>A process can be assigned one of eight discrete priorities represented
by the individual enumerators of TProcessPriority, and range from EPriorityLow, the lowest, to EPrioritySupervisor, the highest. </p> <p>In practice, <em>user processes</em> can only be assigned priorities that are one of
the values: </p> <ul>
<li id="GUID-85AA4A1D-A168-5AEF-9D4C-DC14C28686B2"><a name="GUID-85AA4A1D-A168-5AEF-9D4C-DC14C28686B2"><!-- --></a><p> EPriorityLow <code class="codeph"></code> </p> </li>
<li id="GUID-45B720BB-3696-545F-B966-A2EA4B37AE5D"><a name="GUID-45B720BB-3696-545F-B966-A2EA4B37AE5D"><!-- --></a><p> EPriorityBackground </p> </li>
<li id="GUID-DF2708D4-B670-5B15-B587-CB71EAC99045"><a name="GUID-DF2708D4-B670-5B15-B587-CB71EAC99045"><!-- --></a><p> EPriorityForeGround </p> </li>
<li id="GUID-9C68DD95-2AB6-57D0-9966-D83144788458"><a name="GUID-9C68DD95-2AB6-57D0-9966-D83144788458"><!-- --></a><p> EPriorityHigh </p> </li>
</ul> <p>There are a further four process priorities that a user process
is not permitted to set: <code class="codeph">EPriorityWindowServer</code>, <code class="codeph">EPriorityFileServer</code>, <code class="codeph">EPriorityRealTimeServer</code> and <code class="codeph">EPrioritySupervisor</code>. </p> <p>A process priority
can be assigned: </p> <ul>
<li id="GUID-CC4FA12C-BFDD-5F75-BC18-B742BCACEECF"><a name="GUID-CC4FA12C-BFDD-5F75-BC18-B742BCACEECF"><!-- --></a><p>when the associated <code>.exe</code> is built; this is done by specifying the value in
the <code>.mmp</code> file that defines the project. </p> </li>
<li id="GUID-B86220D9-B10D-5506-AD90-73E7F8D7A089"><a name="GUID-B86220D9-B10D-5506-AD90-73E7F8D7A089"><!-- --></a><p>by calling <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-9DD1EA2B-DC59-315C-8E9C-CE6D9461B695.html#GUID-189A64CB-F2EA-3C8F-A7A7-01CBF8FDE67A"><code class="apiname">RProcess::SetPriority()</code></a> and passing one of the TProcessPriority enum values. </p> </li>
</ul> <p>The priority of a thread <em>relative</em> to
a process is assigned by calling <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-B0E661BC-4058-3256-B9C3-5A4FD52F6DE5.html#GUID-8E412361-AE54-3585-AF2A-45D4A53F8B03"><code class="apiname">RThread::SetPriority()</code></a> and passing one of the five TThreadPriority enum
values: </p> <ul>
<li id="GUID-BCFFB27F-5CEB-58E8-A859-C82273CB7FDC"><a name="GUID-BCFFB27F-5CEB-58E8-A859-C82273CB7FDC"><!-- --></a><p> EPriorityMuchLess </p> </li>
<li id="GUID-21C1A24C-483D-579B-BA56-31B3694215CE"><a name="GUID-21C1A24C-483D-579B-BA56-31B3694215CE"><!-- --></a><p>  EPriorityLess </p> </li>
<li id="GUID-48747F5D-8F0E-5C57-8858-35D8881B1DB7"><a name="GUID-48747F5D-8F0E-5C57-8858-35D8881B1DB7"><!-- --></a><p> EPriorityNormal </p> </li>
<li id="GUID-78DEBC15-DFD8-5384-8358-3744E2C1DDBE"><a name="GUID-78DEBC15-DFD8-5384-8358-3744E2C1DDBE"><!-- --></a><p> EPriorityMore </p> </li>
<li id="GUID-AE42DA32-09CA-5C8B-B9AF-2A68E66E6218"><a name="GUID-AE42DA32-09CA-5C8B-B9AF-2A68E66E6218"><!-- --></a><p>  EPriorityMuchMore </p> </li>
</ul> <p>The <a href="#GUID-F5B98A28-EEDA-58BD-A6CC-62C1621D44DF">thread priority value mapping table</a> shows the <em>true</em> priority
of a thread based on the combination of process priority and process-relative
thread priority </p> <p id="GUID-7A38EE63-E955-5432-84E1-F35CB45C931E"><a name="GUID-7A38EE63-E955-5432-84E1-F35CB45C931E"><!-- --></a><strong>Process-independent
scheme for general user threads</strong> </p> <p>In this scheme, the <em>true</em> priority of a thread is independent of the priority of its
owning process. Changing the priority of the underlying process has
no effect on the <em>true</em> priority of the thread. </p> <p>The priority
of a thread is assigned by calling <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-B0E661BC-4058-3256-B9C3-5A4FD52F6DE5.html#GUID-8E412361-AE54-3585-AF2A-45D4A53F8B03"><code class="apiname">RThread::SetPriority()</code></a> and passing one of the TThreadPriority enum values
listed below. Note that the set of enum values splits into two logical
groupings based on their equivalence to process-relative values. See
the <a href="#GUID-F5B98A28-EEDA-58BD-A6CC-62C1621D44DF">thread priority value mapping table</a>. </p> <div class="tablenoborder"><a name="GUID-A0397BB8-AAC7-5F79-B94F-68103B66132C"><!-- --></a><table cellpadding="4" cellspacing="0" summary="" id="GUID-A0397BB8-AAC7-5F79-B94F-68103B66132C" frame="border" border="1" rules="all">
<tbody>
<tr class="">
<td class="cellrowborder" valign="top"><p> <strong> Group 1 </strong> </p> </td>
<td class="cellrowborder" valign="top"><p> <strong> Group 2 </strong> </p> </td>
</tr>
<tr class="bg ">
<td class="cellrowborder" valign="top"><ul>
<li id="GUID-12430992-C96F-5006-85AD-A9308AB75B93"><a name="GUID-12430992-C96F-5006-85AD-A9308AB75B93"><!-- --></a><p> EPriorityAbsoluteVeryLow </p> </li>
<li id="GUID-A5682ECF-DCAA-5E35-8294-613A30F416FD"><a name="GUID-A5682ECF-DCAA-5E35-8294-613A30F416FD"><!-- --></a><p> EPriorityAbsoluteLow </p> </li>
<li id="GUID-1750EB5D-A22B-5838-9EB8-37B06A0D1F98"><a name="GUID-1750EB5D-A22B-5838-9EB8-37B06A0D1F98"><!-- --></a><p> EPriorityAbsoluteBackground </p> </li>
<li id="GUID-A83FCD79-3B4C-51CC-A82A-BE8AAB9BEEC0"><a name="GUID-A83FCD79-3B4C-51CC-A82A-BE8AAB9BEEC0"><!-- --></a><p> EPriorityAbsoluteForeground </p> </li>
<li id="GUID-1EDD4765-F02A-56CD-882D-E4DD443CE410"><a name="GUID-1EDD4765-F02A-56CD-882D-E4DD443CE410"><!-- --></a><p> EPriorityAbsoluteHigh </p> </li>
</ul> </td>
<td class="cellrowborder" valign="top"><ul>
<li id="GUID-E03FCF50-F5B6-5885-B939-88B513F4AC2F"><a name="GUID-E03FCF50-F5B6-5885-B939-88B513F4AC2F"><!-- --></a><p> EPriorityAbsoluteLowNormal </p> </li>
<li id="GUID-4C94D1D2-6B81-57D8-B44D-2FE19E9971F9"><a name="GUID-4C94D1D2-6B81-57D8-B44D-2FE19E9971F9"><!-- --></a><p> EPriorityAbsoluteBackgroundNormal </p> </li>
<li id="GUID-6D3AA39B-AE42-575A-B63B-D109049ABFEF"><a name="GUID-6D3AA39B-AE42-575A-B63B-D109049ABFEF"><!-- --></a><p> EPriorityAbsoluteForegroundNormal </p> </li>
<li id="GUID-E41572FD-0C50-54BC-98C6-857A8D86CCD7"><a name="GUID-E41572FD-0C50-54BC-98C6-857A8D86CCD7"><!-- --></a><p> EPriorityAbsoluteHighNormal </p> </li>
</ul> </td>
</tr>
</tbody>
</table></div> <p>The <a href="#GUID-F5B98A28-EEDA-58BD-A6CC-62C1621D44DF">thread priority value mapping table</a> shows the resulting <em>true</em> priority of the thread. </p> </div>
<div id="GUID-23801A52-4E62-56F4-8D81-E0A417517FDA"><h3 class="section-title">Priority
scheme for real-time user-side threads</h3> <p>This scheme is the
same as the <a href="#GUID-7A38EE63-E955-5432-84E1-F35CB45C931E">process-independent scheme for general user threads</a>, but with
one essential difference - the range of TThreadPriority enum values to be passed to <a href="GUID-251A35C1-CC66-4DE4-9EBE-964026E89E7F/GUID-B0E661BC-4058-3256-B9C3-5A4FD52F6DE5.html#GUID-8E412361-AE54-3585-AF2A-45D4A53F8B03"><code class="apiname">RThread::SetPriority()</code></a> is as shown below. These priorities map to the <em>true</em> priority
values in the range 24 -31, and can only be set by executables having
the <code class="codeph">ProtServ</code> capability. This range is referred to
as the real time range. </p> <ul>
<li id="GUID-78ACFC22-4FB7-5E90-B6E2-9EF39EA9A3F5"><a name="GUID-78ACFC22-4FB7-5E90-B6E2-9EF39EA9A3F5"><!-- --></a><p> EPriorityAbsoluteRealTime1 </p> </li>
<li id="GUID-3ADBFE8D-E7D9-5316-B06E-E3C514F4221E"><a name="GUID-3ADBFE8D-E7D9-5316-B06E-E3C514F4221E"><!-- --></a><p> EPriorityAbsoluteRealTime2 </p> </li>
<li id="GUID-90F0E400-AB37-52CC-B01E-2D7C3E589111"><a name="GUID-90F0E400-AB37-52CC-B01E-2D7C3E589111"><!-- --></a><p> EPriorityAbsoluteRealTime3 </p> </li>
<li id="GUID-DDB4B69C-9BBD-5E4B-B87C-CF52B4BDAA85"><a name="GUID-DDB4B69C-9BBD-5E4B-B87C-CF52B4BDAA85"><!-- --></a><p>  EPriorityAbsoluteRealTime4 </p> </li>
<li id="GUID-91DEE716-6F45-51C2-8139-B9CB1AE5065B"><a name="GUID-91DEE716-6F45-51C2-8139-B9CB1AE5065B"><!-- --></a><p> EPriorityAbsoluteRealTime5 </p> </li>
<li id="GUID-01B2B0B9-4242-5D8E-83B2-2658CF68548F"><a name="GUID-01B2B0B9-4242-5D8E-83B2-2658CF68548F"><!-- --></a><p> EPriorityAbsoluteRealTime6 </p> </li>
<li id="GUID-6581842F-C83C-53A5-A567-F1D4BE97488C"><a name="GUID-6581842F-C83C-53A5-A567-F1D4BE97488C"><!-- --></a><p> EPriorityAbsoluteRealTime7 </p> </li>
<li id="GUID-C7AB328B-B910-51D2-ADB0-5E8A33AFCD69"><a name="GUID-C7AB328B-B910-51D2-ADB0-5E8A33AFCD69"><!-- --></a><p> EPriorityAbsoluteRealTime8 </p> </li>
</ul> <p>The <a href="#GUID-F5B98A28-EEDA-58BD-A6CC-62C1621D44DF">thread priority value mapping table</a> shows the resulting <em>true</em> priority of the thread. </p> </div>
<div id="GUID-F5B98A28-EEDA-58BD-A6CC-62C1621D44DF"><h3 class="section-title">Thread
priority value mapping table</h3> <p>This table shows the effect
of setting priorities, and the resulting <em>true</em> priority values.
You need to be aware that this may change in the future, and you should
never synchronise threads on the basis of thread priorities. If you
need to synchronise threads, use mutexes or semaphores. </p> <p>Notes </p> <ul>
<li id="GUID-CBC69A23-E3EF-56BC-A915-2770EBFB76C4"><a name="GUID-CBC69A23-E3EF-56BC-A915-2770EBFB76C4"><!-- --></a><p>True priority
values in the shaded region can only be accessed by threads running
in processes with the <code class="codeph">ProtServ</code> capability. </p> </li>
<li id="GUID-1F8FC263-3C39-5E3C-A186-6D5D4DF7D6D3"><a name="GUID-1F8FC263-3C39-5E3C-A186-6D5D4DF7D6D3"><!-- --></a><p>The process-priority
values : EPriorityWindowServer, EPriorityFileServer and EPrioritySupervisor all map to the same range
of priorities. Along with EPriorityRealTimeServer, these have historically been used for system servers and other
processes needing access to high priorities suitable for real-time
tasks, and their use requires <code class="codeph">ProtServ</code> capability. </p> </li>
<li id="GUID-3256F08A-AD30-5378-BFA9-140688B1CDB6"><a name="GUID-3256F08A-AD30-5378-BFA9-140688B1CDB6"><!-- --></a><p>Note that <code class="codeph">ProtServ</code> capability will not be granted to general applications
for the purpose of gaining access to the very high thread priorities.
This risks breaking important system functionality. </p> </li>
</ul> <div class="figure" id="GUID-6BF93712-F8AA-5D08-A5D4-FEB6B22592D8"><img src="GUID-B9306D01-1DE5-511A-AC1A-6E3E9749BA89_d0e319045_href.png" /></div> <p>Note that we have used <em>E'</em> as an abbreviation for <em>EPriority</em> in this diagram. </p> </div>
<div id="GUID-E9AFB6A3-ED3E-5110-82C8-E5E15E0AF899"><h3 class="section-title">Platform
security notes</h3> <p>Platform security restrictions prevent thread
and process priorities from being modified by another user process.
There is one exception: by default, applications have “Priority Control”
enabled for them which allows the window server to switch them between
foreground and background process priorities depending on which has
foreground focus. </p> </div>
</div></div></div><div class="footer"><p class="metadata">Last updated July 7th, 2010</p><hr /><div class="copy">© Nokia 2011.</div></div></body>
<!-- Mirrored from devlib.symbian.slions.net/s3/GUID-7B173E02-9697-51F4-A7E8-795AEF547109.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 27 Mar 2020 06:08:08 GMT -->
</html>